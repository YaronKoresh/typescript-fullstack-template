import {createRequire}from'module';import {spawn,execSync}from'child_process';import hl from'http';import Yi from'net';import Fs from'path';import Be from'process';import {fileURLToPath}from'url';import Ps from'fs';import rl from'https';import at from'os';const require$1 = createRequire(import.meta.url);
var $i=Object.create;var qs=Object.defineProperty;var en=Object.getOwnPropertyDescriptor;var tn=Object.getOwnPropertyNames;var sn=Object.getPrototypeOf,rn=Object.prototype.hasOwnProperty;var k=(s=>typeof require$1<"u"?require$1:typeof Proxy<"u"?new Proxy(s,{get:(e,t)=>(typeof require$1<"u"?require$1:e)[t]}):s)(function(s){if(typeof require$1<"u")return require$1.apply(this,arguments);throw Error('Dynamic require of "'+s+'" is not supported')});var p=(s,e)=>()=>(e||s((e={exports:{}}).exports,e),e.exports);var nn=(s,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of tn(e))!rn.call(s,i)&&i!==t&&qs(s,i,{get:()=>e[i],enumerable:!(r=en(e,i))||r.enumerable});return s};var on=(s,e,t)=>(t=s!=null?$i(sn(s)):{},nn(qs(t,"default",{value:s,enumerable:true}),s));var js=p((kl,an)=>{an.exports={acl:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},append:{arity:3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},asking:{arity:1,flags:["fast"],keyStart:0,keyStop:0,step:0},auth:{arity:-2,flags:["noscript","loading","stale","fast","no_auth","allow_busy"],keyStart:0,keyStop:0,step:0},bgrewriteaof:{arity:1,flags:["admin","noscript","no_async_loading"],keyStart:0,keyStop:0,step:0},bgsave:{arity:-1,flags:["admin","noscript","no_async_loading"],keyStart:0,keyStop:0,step:0},bitcount:{arity:-2,flags:["readonly"],keyStart:1,keyStop:1,step:1},bitfield:{arity:-2,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},bitfield_ro:{arity:-2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},bitop:{arity:-4,flags:["write","denyoom"],keyStart:2,keyStop:-1,step:1},bitpos:{arity:-3,flags:["readonly"],keyStart:1,keyStop:1,step:1},blmove:{arity:6,flags:["write","denyoom","noscript","blocking"],keyStart:1,keyStop:2,step:1},blmpop:{arity:-5,flags:["write","blocking","movablekeys"],keyStart:0,keyStop:0,step:0},blpop:{arity:-3,flags:["write","noscript","blocking"],keyStart:1,keyStop:-2,step:1},brpop:{arity:-3,flags:["write","noscript","blocking"],keyStart:1,keyStop:-2,step:1},brpoplpush:{arity:4,flags:["write","denyoom","noscript","blocking"],keyStart:1,keyStop:2,step:1},bzmpop:{arity:-5,flags:["write","blocking","movablekeys"],keyStart:0,keyStop:0,step:0},bzpopmax:{arity:-3,flags:["write","noscript","blocking","fast"],keyStart:1,keyStop:-2,step:1},bzpopmin:{arity:-3,flags:["write","noscript","blocking","fast"],keyStart:1,keyStop:-2,step:1},client:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},cluster:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},command:{arity:-1,flags:["loading","stale"],keyStart:0,keyStop:0,step:0},config:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},copy:{arity:-3,flags:["write","denyoom"],keyStart:1,keyStop:2,step:1},dbsize:{arity:1,flags:["readonly","fast"],keyStart:0,keyStop:0,step:0},debug:{arity:-2,flags:["admin","noscript","loading","stale"],keyStart:0,keyStop:0,step:0},decr:{arity:2,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},decrby:{arity:3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},del:{arity:-2,flags:["write"],keyStart:1,keyStop:-1,step:1},discard:{arity:1,flags:["noscript","loading","stale","fast","allow_busy"],keyStart:0,keyStop:0,step:0},dump:{arity:2,flags:["readonly"],keyStart:1,keyStop:1,step:1},echo:{arity:2,flags:["fast"],keyStart:0,keyStop:0,step:0},eval:{arity:-3,flags:["noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],keyStart:0,keyStop:0,step:0},eval_ro:{arity:-3,flags:["readonly","noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],keyStart:0,keyStop:0,step:0},evalsha:{arity:-3,flags:["noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],keyStart:0,keyStop:0,step:0},evalsha_ro:{arity:-3,flags:["readonly","noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],keyStart:0,keyStop:0,step:0},exec:{arity:1,flags:["noscript","loading","stale","skip_slowlog"],keyStart:0,keyStop:0,step:0},exists:{arity:-2,flags:["readonly","fast"],keyStart:1,keyStop:-1,step:1},expire:{arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},expireat:{arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},expiretime:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},failover:{arity:-1,flags:["admin","noscript","stale"],keyStart:0,keyStop:0,step:0},fcall:{arity:-3,flags:["noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],keyStart:0,keyStop:0,step:0},fcall_ro:{arity:-3,flags:["readonly","noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],keyStart:0,keyStop:0,step:0},flushall:{arity:-1,flags:["write"],keyStart:0,keyStop:0,step:0},flushdb:{arity:-1,flags:["write"],keyStart:0,keyStop:0,step:0},function:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},geoadd:{arity:-5,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},geodist:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},geohash:{arity:-2,flags:["readonly"],keyStart:1,keyStop:1,step:1},geopos:{arity:-2,flags:["readonly"],keyStart:1,keyStop:1,step:1},georadius:{arity:-6,flags:["write","denyoom","movablekeys"],keyStart:1,keyStop:1,step:1},georadius_ro:{arity:-6,flags:["readonly"],keyStart:1,keyStop:1,step:1},georadiusbymember:{arity:-5,flags:["write","denyoom","movablekeys"],keyStart:1,keyStop:1,step:1},georadiusbymember_ro:{arity:-5,flags:["readonly"],keyStart:1,keyStop:1,step:1},geosearch:{arity:-7,flags:["readonly"],keyStart:1,keyStop:1,step:1},geosearchstore:{arity:-8,flags:["write","denyoom"],keyStart:1,keyStop:2,step:1},get:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},getbit:{arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},getdel:{arity:2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},getex:{arity:-2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},getrange:{arity:4,flags:["readonly"],keyStart:1,keyStop:1,step:1},getset:{arity:3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},hdel:{arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},hello:{arity:-1,flags:["noscript","loading","stale","fast","no_auth","allow_busy"],keyStart:0,keyStop:0,step:0},hexists:{arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},hexpire:{arity:-6,flags:["write","fast"],keyStart:1,keyStop:1,step:1},hpexpire:{arity:-6,flags:["write","fast"],keyStart:1,keyStop:1,step:1},hget:{arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},hgetall:{arity:2,flags:["readonly"],keyStart:1,keyStop:1,step:1},hincrby:{arity:4,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},hincrbyfloat:{arity:4,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},hkeys:{arity:2,flags:["readonly"],keyStart:1,keyStop:1,step:1},hlen:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},hmget:{arity:-3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},hmset:{arity:-4,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},hrandfield:{arity:-2,flags:["readonly"],keyStart:1,keyStop:1,step:1},hscan:{arity:-3,flags:["readonly"],keyStart:1,keyStop:1,step:1},hset:{arity:-4,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},hsetnx:{arity:4,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},hstrlen:{arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},hvals:{arity:2,flags:["readonly"],keyStart:1,keyStop:1,step:1},incr:{arity:2,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},incrby:{arity:3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},incrbyfloat:{arity:3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},info:{arity:-1,flags:["loading","stale"],keyStart:0,keyStop:0,step:0},keys:{arity:2,flags:["readonly"],keyStart:0,keyStop:0,step:0},lastsave:{arity:1,flags:["loading","stale","fast"],keyStart:0,keyStop:0,step:0},latency:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},lcs:{arity:-3,flags:["readonly"],keyStart:1,keyStop:2,step:1},lindex:{arity:3,flags:["readonly"],keyStart:1,keyStop:1,step:1},linsert:{arity:5,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},llen:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},lmove:{arity:5,flags:["write","denyoom"],keyStart:1,keyStop:2,step:1},lmpop:{arity:-4,flags:["write","movablekeys"],keyStart:0,keyStop:0,step:0},lolwut:{arity:-1,flags:["readonly","fast"],keyStart:0,keyStop:0,step:0},lpop:{arity:-2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},lpos:{arity:-3,flags:["readonly"],keyStart:1,keyStop:1,step:1},lpush:{arity:-3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},lpushx:{arity:-3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},lrange:{arity:4,flags:["readonly"],keyStart:1,keyStop:1,step:1},lrem:{arity:4,flags:["write"],keyStart:1,keyStop:1,step:1},lset:{arity:4,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},ltrim:{arity:4,flags:["write"],keyStart:1,keyStop:1,step:1},memory:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},mget:{arity:-2,flags:["readonly","fast"],keyStart:1,keyStop:-1,step:1},migrate:{arity:-6,flags:["write","movablekeys"],keyStart:3,keyStop:3,step:1},module:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},monitor:{arity:1,flags:["admin","noscript","loading","stale"],keyStart:0,keyStop:0,step:0},move:{arity:3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},mset:{arity:-3,flags:["write","denyoom"],keyStart:1,keyStop:-1,step:2},msetnx:{arity:-3,flags:["write","denyoom"],keyStart:1,keyStop:-1,step:2},multi:{arity:1,flags:["noscript","loading","stale","fast","allow_busy"],keyStart:0,keyStop:0,step:0},object:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},persist:{arity:2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},pexpire:{arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},pexpireat:{arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},pexpiretime:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},pfadd:{arity:-2,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},pfcount:{arity:-2,flags:["readonly"],keyStart:1,keyStop:-1,step:1},pfdebug:{arity:3,flags:["write","denyoom","admin"],keyStart:2,keyStop:2,step:1},pfmerge:{arity:-2,flags:["write","denyoom"],keyStart:1,keyStop:-1,step:1},pfselftest:{arity:1,flags:["admin"],keyStart:0,keyStop:0,step:0},ping:{arity:-1,flags:["fast"],keyStart:0,keyStop:0,step:0},psetex:{arity:4,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},psubscribe:{arity:-2,flags:["pubsub","noscript","loading","stale"],keyStart:0,keyStop:0,step:0},psync:{arity:-3,flags:["admin","noscript","no_async_loading","no_multi"],keyStart:0,keyStop:0,step:0},pttl:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},publish:{arity:3,flags:["pubsub","loading","stale","fast"],keyStart:0,keyStop:0,step:0},pubsub:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},punsubscribe:{arity:-1,flags:["pubsub","noscript","loading","stale"],keyStart:0,keyStop:0,step:0},quit:{arity:-1,flags:["noscript","loading","stale","fast","no_auth","allow_busy"],keyStart:0,keyStop:0,step:0},randomkey:{arity:1,flags:["readonly"],keyStart:0,keyStop:0,step:0},readonly:{arity:1,flags:["loading","stale","fast"],keyStart:0,keyStop:0,step:0},readwrite:{arity:1,flags:["loading","stale","fast"],keyStart:0,keyStop:0,step:0},rename:{arity:3,flags:["write"],keyStart:1,keyStop:2,step:1},renamenx:{arity:3,flags:["write","fast"],keyStart:1,keyStop:2,step:1},replconf:{arity:-1,flags:["admin","noscript","loading","stale","allow_busy"],keyStart:0,keyStop:0,step:0},replicaof:{arity:3,flags:["admin","noscript","stale","no_async_loading"],keyStart:0,keyStop:0,step:0},reset:{arity:1,flags:["noscript","loading","stale","fast","no_auth","allow_busy"],keyStart:0,keyStop:0,step:0},restore:{arity:-4,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},"restore-asking":{arity:-4,flags:["write","denyoom","asking"],keyStart:1,keyStop:1,step:1},role:{arity:1,flags:["noscript","loading","stale","fast"],keyStart:0,keyStop:0,step:0},rpop:{arity:-2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},rpoplpush:{arity:3,flags:["write","denyoom"],keyStart:1,keyStop:2,step:1},rpush:{arity:-3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},rpushx:{arity:-3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},sadd:{arity:-3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},save:{arity:1,flags:["admin","noscript","no_async_loading","no_multi"],keyStart:0,keyStop:0,step:0},scan:{arity:-2,flags:["readonly"],keyStart:0,keyStop:0,step:0},scard:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},script:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},sdiff:{arity:-2,flags:["readonly"],keyStart:1,keyStop:-1,step:1},sdiffstore:{arity:-3,flags:["write","denyoom"],keyStart:1,keyStop:-1,step:1},select:{arity:2,flags:["loading","stale","fast"],keyStart:0,keyStop:0,step:0},set:{arity:-3,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},setbit:{arity:4,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},setex:{arity:4,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},setnx:{arity:3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},setrange:{arity:4,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},shutdown:{arity:-1,flags:["admin","noscript","loading","stale","no_multi","allow_busy"],keyStart:0,keyStop:0,step:0},sinter:{arity:-2,flags:["readonly"],keyStart:1,keyStop:-1,step:1},sintercard:{arity:-3,flags:["readonly","movablekeys"],keyStart:0,keyStop:0,step:0},sinterstore:{arity:-3,flags:["write","denyoom"],keyStart:1,keyStop:-1,step:1},sismember:{arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},slaveof:{arity:3,flags:["admin","noscript","stale","no_async_loading"],keyStart:0,keyStop:0,step:0},slowlog:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},smembers:{arity:2,flags:["readonly"],keyStart:1,keyStop:1,step:1},smismember:{arity:-3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},smove:{arity:4,flags:["write","fast"],keyStart:1,keyStop:2,step:1},sort:{arity:-2,flags:["write","denyoom","movablekeys"],keyStart:1,keyStop:1,step:1},sort_ro:{arity:-2,flags:["readonly","movablekeys"],keyStart:1,keyStop:1,step:1},spop:{arity:-2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},spublish:{arity:3,flags:["pubsub","loading","stale","fast"],keyStart:1,keyStop:1,step:1},srandmember:{arity:-2,flags:["readonly"],keyStart:1,keyStop:1,step:1},srem:{arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},sscan:{arity:-3,flags:["readonly"],keyStart:1,keyStop:1,step:1},ssubscribe:{arity:-2,flags:["pubsub","noscript","loading","stale"],keyStart:1,keyStop:-1,step:1},strlen:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},subscribe:{arity:-2,flags:["pubsub","noscript","loading","stale"],keyStart:0,keyStop:0,step:0},substr:{arity:4,flags:["readonly"],keyStart:1,keyStop:1,step:1},sunion:{arity:-2,flags:["readonly"],keyStart:1,keyStop:-1,step:1},sunionstore:{arity:-3,flags:["write","denyoom"],keyStart:1,keyStop:-1,step:1},sunsubscribe:{arity:-1,flags:["pubsub","noscript","loading","stale"],keyStart:1,keyStop:-1,step:1},swapdb:{arity:3,flags:["write","fast"],keyStart:0,keyStop:0,step:0},sync:{arity:1,flags:["admin","noscript","no_async_loading","no_multi"],keyStart:0,keyStop:0,step:0},time:{arity:1,flags:["loading","stale","fast"],keyStart:0,keyStop:0,step:0},touch:{arity:-2,flags:["readonly","fast"],keyStart:1,keyStop:-1,step:1},ttl:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},type:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},unlink:{arity:-2,flags:["write","fast"],keyStart:1,keyStop:-1,step:1},unsubscribe:{arity:-1,flags:["pubsub","noscript","loading","stale"],keyStart:0,keyStop:0,step:0},unwatch:{arity:1,flags:["noscript","loading","stale","fast","allow_busy"],keyStart:0,keyStop:0,step:0},wait:{arity:3,flags:["noscript"],keyStart:0,keyStop:0,step:0},watch:{arity:-2,flags:["noscript","loading","stale","fast","allow_busy"],keyStart:1,keyStop:-1,step:1},xack:{arity:-4,flags:["write","fast"],keyStart:1,keyStop:1,step:1},xadd:{arity:-5,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},xautoclaim:{arity:-6,flags:["write","fast"],keyStart:1,keyStop:1,step:1},xclaim:{arity:-6,flags:["write","fast"],keyStart:1,keyStop:1,step:1},xdel:{arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},xdelex:{arity:-5,flags:["write","fast"],keyStart:1,keyStop:1,step:1},xgroup:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},xinfo:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},xlen:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},xpending:{arity:-3,flags:["readonly"],keyStart:1,keyStop:1,step:1},xrange:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},xread:{arity:-4,flags:["readonly","blocking","movablekeys"],keyStart:0,keyStop:0,step:0},xreadgroup:{arity:-7,flags:["write","blocking","movablekeys"],keyStart:0,keyStop:0,step:0},xrevrange:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},xsetid:{arity:-3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},xtrim:{arity:-4,flags:["write"],keyStart:1,keyStop:1,step:1},zadd:{arity:-4,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},zcard:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},zcount:{arity:4,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},zdiff:{arity:-3,flags:["readonly","movablekeys"],keyStart:0,keyStop:0,step:0},zdiffstore:{arity:-4,flags:["write","denyoom","movablekeys"],keyStart:1,keyStop:1,step:1},zincrby:{arity:4,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},zinter:{arity:-3,flags:["readonly","movablekeys"],keyStart:0,keyStop:0,step:0},zintercard:{arity:-3,flags:["readonly","movablekeys"],keyStart:0,keyStop:0,step:0},zinterstore:{arity:-4,flags:["write","denyoom","movablekeys"],keyStart:1,keyStop:1,step:1},zlexcount:{arity:4,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},zmpop:{arity:-4,flags:["write","movablekeys"],keyStart:0,keyStop:0,step:0},zmscore:{arity:-3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},zpopmax:{arity:-2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},zpopmin:{arity:-2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},zrandmember:{arity:-2,flags:["readonly"],keyStart:1,keyStop:1,step:1},zrange:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},zrangebylex:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},zrangebyscore:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},zrangestore:{arity:-5,flags:["write","denyoom"],keyStart:1,keyStop:2,step:1},zrank:{arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},zrem:{arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},zremrangebylex:{arity:4,flags:["write"],keyStart:1,keyStop:1,step:1},zremrangebyrank:{arity:4,flags:["write"],keyStart:1,keyStop:1,step:1},zremrangebyscore:{arity:4,flags:["write"],keyStart:1,keyStop:1,step:1},zrevrange:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},zrevrangebylex:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},zrevrangebyscore:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},zrevrank:{arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},zscan:{arity:-3,flags:["readonly"],keyStart:1,keyStop:1,step:1},zscore:{arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},zunion:{arity:-3,flags:["readonly","movablekeys"],keyStart:0,keyStop:0,step:0},zunionstore:{arity:-4,flags:["write","denyoom","movablekeys"],keyStart:1,keyStop:1,step:1}};});var ae=p(R=>{var cn=R&&R.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(R,"__esModule",{value:true});R.getKeyIndexes=R.hasFlag=R.exists=R.list=void 0;var De=cn(js());R.list=Object.keys(De.default);var lt={};R.list.forEach(s=>{lt[s]=De.default[s].flags.reduce(function(e,t){return e[t]=true,e},{});});function ln(s,e){return s=e?.caseInsensitive?String(s).toLowerCase():s,!!De.default[s]}R.exists=ln;function un(s,e,t){if(s=t?.nameCaseInsensitive?String(s).toLowerCase():s,!lt[s])throw new Error("Unknown command "+s);return !!lt[s][e]}R.hasFlag=un;function fn(s,e,t){s=t?.nameCaseInsensitive?String(s).toLowerCase():s;let r=De.default[s];if(!r)throw new Error("Unknown command "+s);if(!Array.isArray(e))throw new Error("Expect args to be an array");let i=[],n=!!(t&&t.parseExternalKey),o=(a,u)=>{let f=[],l=Number(a[u]);for(let h=0;h<l;h++)f.push(h+u+1);return f},c=(a,u,f)=>{for(let l=u;l<a.length-1;l+=1)if(String(a[l]).toLowerCase()===f.toLowerCase())return l+1;return null};switch(s){case "zunionstore":case "zinterstore":case "zdiffstore":i.push(0,...o(e,1));break;case "eval":case "evalsha":case "eval_ro":case "evalsha_ro":case "fcall":case "fcall_ro":case "blmpop":case "bzmpop":i.push(...o(e,1));break;case "sintercard":case "lmpop":case "zunion":case "zinter":case "zmpop":case "zintercard":case "zdiff":{i.push(...o(e,0));break}case "georadius":{i.push(0);let a=c(e,5,"STORE");a&&i.push(a);let u=c(e,5,"STOREDIST");u&&i.push(u);break}case "georadiusbymember":{i.push(0);let a=c(e,4,"STORE");a&&i.push(a);let u=c(e,4,"STOREDIST");u&&i.push(u);break}case "sort":case "sort_ro":i.push(0);for(let a=1;a<e.length-1;a++){let u=e[a];if(typeof u!="string")continue;let f=u.toUpperCase();f==="GET"?(a+=1,u=e[a],u!=="#"&&(n?i.push([a,Ls(u)]):i.push(a))):f==="BY"?(a+=1,n?i.push([a,Ls(e[a])]):i.push(a)):f==="STORE"&&(a+=1,i.push(a));}break;case "migrate":if(e[2]==="")for(let a=5;a<e.length-1;a++){let u=e[a];if(typeof u=="string"&&u.toUpperCase()==="KEYS"){for(let f=a+1;f<e.length;f++)i.push(f);break}}else i.push(2);break;case "xreadgroup":case "xread":for(let a=s==="xread"?0:3;a<e.length-1;a++)if(String(e[a]).toUpperCase()==="STREAMS"){for(let u=a+1;u<=a+(e.length-1-a)/2;u++)i.push(u);break}break;default:if(r.step>0){let a=r.keyStart-1,u=r.keyStop>0?r.keyStop:e.length+r.keyStop+1;for(let f=a;f<u;f+=r.step)i.push(f);}break}return i}R.getKeyIndexes=fn;function Ls(s){typeof s!="string"&&(s=String(s));let e=s.indexOf("->");return e===-1?s.length:e}});var Qs=p(U=>{Object.defineProperty(U,"__esModule",{value:true});U.tryCatch=U.errorObj=void 0;U.errorObj={e:{}};var ut;function hn(s,e){try{let t=ut;return ut=null,t.apply(this,arguments)}catch(t){return U.errorObj.e=t,U.errorObj}}function dn(s){return ut=s,hn}U.tryCatch=dn;});var K=p(ft=>{Object.defineProperty(ft,"__esModule",{value:true});var ce=Qs();function zs(s){setTimeout(function(){throw s},0);}function pn(s,e,t){return typeof e=="function"&&s.then(r=>{let i;t!==void 0&&Object(t).spread&&Array.isArray(r)?i=ce.tryCatch(e).apply(void 0,[null].concat(r)):i=r===void 0?ce.tryCatch(e)(null):ce.tryCatch(e)(null,r),i===ce.errorObj&&zs(i.e);},r=>{if(!r){let n=new Error(r+"");Object.assign(n,{cause:r}),r=n;}let i=ce.tryCatch(e)(r);i===ce.errorObj&&zs(i.e);}),s}ft.default=pn;});var Ks=p((wl,Us)=>{var Gs=k("assert"),ve=k("util");function le(s){Object.defineProperty(this,"message",{value:s||"",configurable:true,writable:true}),Error.captureStackTrace(this,this.constructor);}ve.inherits(le,Error);Object.defineProperty(le.prototype,"name",{value:"RedisError",configurable:true,writable:true});function ht(s,e,t){Gs(e),Gs.strictEqual(typeof t,"number"),Object.defineProperty(this,"message",{value:s||"",configurable:true,writable:true});let r=Error.stackTraceLimit;Error.stackTraceLimit=2,Error.captureStackTrace(this,this.constructor),Error.stackTraceLimit=r,this.offset=t,this.buffer=e;}ve.inherits(ht,le);Object.defineProperty(ht.prototype,"name",{value:"ParserError",configurable:true,writable:true});function dt(s){Object.defineProperty(this,"message",{value:s||"",configurable:true,writable:true});let e=Error.stackTraceLimit;Error.stackTraceLimit=2,Error.captureStackTrace(this,this.constructor),Error.stackTraceLimit=e;}ve.inherits(dt,le);Object.defineProperty(dt.prototype,"name",{value:"ReplyError",configurable:true,writable:true});function Ne(s){Object.defineProperty(this,"message",{value:s||"",configurable:true,writable:true}),Error.captureStackTrace(this,this.constructor);}ve.inherits(Ne,le);Object.defineProperty(Ne.prototype,"name",{value:"AbortError",configurable:true,writable:true});function pt(s){Object.defineProperty(this,"message",{value:s||"",configurable:true,writable:true}),Error.captureStackTrace(this,this.constructor);}ve.inherits(pt,Ne);Object.defineProperty(pt.prototype,"name",{value:"InterruptError",configurable:true,writable:true});Us.exports={RedisError:le,ParserError:ht,ReplyError:dt,AbortError:Ne,InterruptError:pt};});var Hs=p((El,Ys)=>{var Vs=k("assert"),ue=class extends Error{get name(){return this.constructor.name}},yt=class extends ue{constructor(e,t,r){Vs(t),Vs.strictEqual(typeof r,"number");let i=Error.stackTraceLimit;Error.stackTraceLimit=2,super(e),Error.stackTraceLimit=i,this.offset=r,this.buffer=t;}get name(){return this.constructor.name}},gt=class extends ue{constructor(e){let t=Error.stackTraceLimit;Error.stackTraceLimit=2,super(e),Error.stackTraceLimit=t;}get name(){return this.constructor.name}},qe=class extends ue{get name(){return this.constructor.name}},mt=class extends qe{get name(){return this.constructor.name}};Ys.exports={RedisError:ue,ParserError:yt,ReplyError:gt,AbortError:qe,InterruptError:mt};});var se=p((xl,Ws)=>{var yn=process.version.charCodeAt(1)<55&&process.version.charCodeAt(2)===46?Ks():Hs();Ws.exports=yn;});var we=p((Al,bt)=>{var Js=[0,4129,8258,12387,16516,20645,24774,28903,33032,37161,41290,45419,49548,53677,57806,61935,4657,528,12915,8786,21173,17044,29431,25302,37689,33560,45947,41818,54205,50076,62463,58334,9314,13379,1056,5121,25830,29895,17572,21637,42346,46411,34088,38153,58862,62927,50604,54669,13907,9842,5649,1584,30423,26358,22165,18100,46939,42874,38681,34616,63455,59390,55197,51132,18628,22757,26758,30887,2112,6241,10242,14371,51660,55789,59790,63919,35144,39273,43274,47403,23285,19156,31415,27286,6769,2640,14899,10770,56317,52188,64447,60318,39801,35672,47931,43802,27814,31879,19684,23749,11298,15363,3168,7233,60846,64911,52716,56781,44330,48395,36200,40265,32407,28342,24277,20212,15891,11826,7761,3696,65439,61374,57309,53244,48923,44858,40793,36728,37256,33193,45514,41451,53516,49453,61774,57711,4224,161,12482,8419,20484,16421,28742,24679,33721,37784,41979,46042,49981,54044,58239,62302,689,4752,8947,13010,16949,21012,25207,29270,46570,42443,38312,34185,62830,58703,54572,50445,13538,9411,5280,1153,29798,25671,21540,17413,42971,47098,34713,38840,59231,63358,50973,55100,9939,14066,1681,5808,26199,30326,17941,22068,55628,51565,63758,59695,39368,35305,47498,43435,22596,18533,30726,26663,6336,2273,14466,10403,52093,56156,60223,64286,35833,39896,43963,48026,19061,23124,27191,31254,2801,6864,10931,14994,64814,60687,56684,52557,48554,44427,40424,36297,31782,27655,23652,19525,15522,11395,7392,3265,61215,65342,53085,57212,44955,49082,36825,40952,28183,32310,20053,24180,11923,16050,3793,7920],gn=function(e){for(var t,r=0,i=0,n=[],o=e.length;r<o;r++)t=e.charCodeAt(r),t<128?n[i++]=t:t<2048?(n[i++]=t>>6|192,n[i++]=t&63|128):(t&64512)===55296&&r+1<e.length&&(e.charCodeAt(r+1)&64512)===56320?(t=65536+((t&1023)<<10)+(e.charCodeAt(++r)&1023),n[i++]=t>>18|240,n[i++]=t>>12&63|128,n[i++]=t>>6&63|128,n[i++]=t&63|128):(n[i++]=t>>12|224,n[i++]=t>>6&63|128,n[i++]=t&63|128);return n},Xs=bt.exports=function(e){for(var t,r=0,i=-1,n=0,o=0,c=typeof e=="string"?gn(e):e,a=c.length;r<a;){if(t=c[r++],i===-1)t===123&&(i=r);else if(t!==125)o=Js[(t^o>>8)&255]^o<<8;else if(r-1!==i)return o&16383;n=Js[(t^n>>8)&255]^n<<8;}return n&16383};bt.exports.generateMulti=function(e){for(var t=1,r=e.length,i=Xs(e[0]);t<r;)if(Xs(e[t++])!==i)return  -1;return i};});var nr=p((Tl,ir)=>{var $s=9007199254740991,mn="[object Arguments]",bn="[object Function]",Sn="[object GeneratorFunction]",kn=/^(?:0|[1-9]\d*)$/;function er(s,e,t){switch(t.length){case 0:return s.call(e);case 1:return s.call(e,t[0]);case 2:return s.call(e,t[0],t[1]);case 3:return s.call(e,t[0],t[1],t[2])}return s.apply(e,t)}function Cn(s,e){for(var t=-1,r=Array(s);++t<s;)r[t]=e(t);return r}var Ee=Object.prototype,xe=Ee.hasOwnProperty,tr=Ee.toString,_n=Ee.propertyIsEnumerable,Zs=Math.max;function vn(s,e){var t=In(s)||Bn(s)?Cn(s.length,String):[],r=t.length,i=!!r;for(var n in s)!(i&&(n=="length"||rr(n,r)))&&t.push(n);return t}function wn(s,e,t,r){return s===void 0||St(s,Ee[t])&&!xe.call(r,t)?e:s}function En(s,e,t){var r=s[e];(!(xe.call(s,e)&&St(r,t))||t===void 0&&!(e in s))&&(s[e]=t);}function xn(s){if(!Ct(s))return Rn(s);var e=Mn(s),t=[];for(var r in s)r=="constructor"&&(e||!xe.call(s,r))||t.push(r);return t}function sr(s,e){return e=Zs(e===void 0?s.length-1:e,0),function(){for(var t=arguments,r=-1,i=Zs(t.length-e,0),n=Array(i);++r<i;)n[r]=t[e+r];r=-1;for(var o=Array(e+1);++r<e;)o[r]=t[r];return o[e]=n,er(s,this,o)}}function An(s,e,t,r){t||(t={});for(var i=-1,n=e.length;++i<n;){var o=e[i],c=r?r(t[o],s[o],o,t,s):void 0;En(t,o,c===void 0?s[o]:c);}return t}function Tn(s){return sr(function(e,t){var r=-1,i=t.length,n=i>1?t[i-1]:void 0,o=i>2?t[2]:void 0;for(n=s.length>3&&typeof n=="function"?(i--,n):void 0,o&&On(t[0],t[1],o)&&(n=i<3?void 0:n,i=1),e=Object(e);++r<i;){var c=t[r];c&&s(e,c,r,n);}return e})}function rr(s,e){return e=e??$s,!!e&&(typeof s=="number"||kn.test(s))&&s>-1&&s%1==0&&s<e}function On(s,e,t){if(!Ct(t))return  false;var r=typeof e;return (r=="number"?kt(t)&&rr(e,t.length):r=="string"&&e in t)?St(t[e],s):false}function Mn(s){var e=s&&s.constructor,t=typeof e=="function"&&e.prototype||Ee;return s===t}function Rn(s){var e=[];if(s!=null)for(var t in Object(s))e.push(t);return e}function St(s,e){return s===e||s!==s&&e!==e}function Bn(s){return Pn(s)&&xe.call(s,"callee")&&(!_n.call(s,"callee")||tr.call(s)==mn)}var In=Array.isArray;function kt(s){return s!=null&&Dn(s.length)&&!Fn(s)}function Pn(s){return Nn(s)&&kt(s)}function Fn(s){var e=Ct(s)?tr.call(s):"";return e==bn||e==Sn}function Dn(s){return typeof s=="number"&&s>-1&&s%1==0&&s<=$s}function Ct(s){var e=typeof s;return !!s&&(e=="object"||e=="function")}function Nn(s){return !!s&&typeof s=="object"}var qn=Tn(function(s,e,t,r){An(e,Ln(e),s,r);}),jn=sr(function(s){return s.push(void 0,wn),er(qn,void 0,s)});function Ln(s){return kt(s)?vn(s):xn(s)}ir.exports=jn;});var cr=p((Ol,ar)=>{var Qn=9007199254740991,zn="[object Arguments]",Gn="[object Function]",Un="[object GeneratorFunction]",_t=Object.prototype,Kn=_t.hasOwnProperty,or=_t.toString,Vn=_t.propertyIsEnumerable;function Yn(s){return Wn(s)&&Kn.call(s,"callee")&&(!Vn.call(s,"callee")||or.call(s)==zn)}function Hn(s){return s!=null&&Xn(s.length)&&!Jn(s)}function Wn(s){return $n(s)&&Hn(s)}function Jn(s){var e=Zn(s)?or.call(s):"";return e==Gn||e==Un}function Xn(s){return typeof s=="number"&&s>-1&&s%1==0&&s<=Qn}function Zn(s){var e=typeof s;return !!s&&(e=="object"||e=="function")}function $n(s){return !!s&&typeof s=="object"}ar.exports=Yn;});var je=p(V=>{Object.defineProperty(V,"__esModule",{value:true});V.isArguments=V.defaults=V.noop=void 0;var eo=nr();V.defaults=eo;var to=cr();V.isArguments=to;function so(){}V.noop=so;});var ur=p((Rl,lr)=>{var fe=1e3,he=fe*60,de=he*60,re=de*24,ro=re*7,io=re*365.25;lr.exports=function(s,e){e=e||{};var t=typeof s;if(t==="string"&&s.length>0)return no(s);if(t==="number"&&isFinite(s))return e.long?ao(s):oo(s);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(s))};function no(s){if(s=String(s),!(s.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(s);if(e){var t=parseFloat(e[1]),r=(e[2]||"ms").toLowerCase();switch(r){case "years":case "year":case "yrs":case "yr":case "y":return t*io;case "weeks":case "week":case "w":return t*ro;case "days":case "day":case "d":return t*re;case "hours":case "hour":case "hrs":case "hr":case "h":return t*de;case "minutes":case "minute":case "mins":case "min":case "m":return t*he;case "seconds":case "second":case "secs":case "sec":case "s":return t*fe;case "milliseconds":case "millisecond":case "msecs":case "msec":case "ms":return t;default:return}}}}function oo(s){var e=Math.abs(s);return e>=re?Math.round(s/re)+"d":e>=de?Math.round(s/de)+"h":e>=he?Math.round(s/he)+"m":e>=fe?Math.round(s/fe)+"s":s+"ms"}function ao(s){var e=Math.abs(s);return e>=re?Le(s,e,re,"day"):e>=de?Le(s,e,de,"hour"):e>=he?Le(s,e,he,"minute"):e>=fe?Le(s,e,fe,"second"):s+" ms"}function Le(s,e,t,r){var i=e>=t*1.5;return Math.round(s/t)+" "+r+(i?"s":"")}});var vt=p((Bl,fr)=>{function co(s){t.debug=t,t.default=t,t.coerce=a,t.disable=o,t.enable=i,t.enabled=c,t.humanize=ur(),t.destroy=u,Object.keys(s).forEach(f=>{t[f]=s[f];}),t.names=[],t.skips=[],t.formatters={};function e(f){let l=0;for(let h=0;h<f.length;h++)l=(l<<5)-l+f.charCodeAt(h),l|=0;return t.colors[Math.abs(l)%t.colors.length]}t.selectColor=e;function t(f){let l,h=null,d,g;function v(...m){if(!v.enabled)return;let te=v,Pe=Number(new Date),Ji=Pe-(l||Pe);te.diff=Ji,te.prev=l,te.curr=Pe,l=Pe,m[0]=t.coerce(m[0]),typeof m[0]!="string"&&m.unshift("%O");let Fe=0;m[0]=m[0].replace(/%([a-zA-Z%])/g,(ct,Xi)=>{if(ct==="%%")return "%";Fe++;let Ns=t.formatters[Xi];if(typeof Ns=="function"){let Zi=m[Fe];ct=Ns.call(te,Zi),m.splice(Fe,1),Fe--;}return ct}),t.formatArgs.call(te,m),(te.log||t.log).apply(te,m);}return v.namespace=f,v.useColors=t.useColors(),v.color=t.selectColor(f),v.extend=r,v.destroy=t.destroy,Object.defineProperty(v,"enabled",{enumerable:true,configurable:false,get:()=>h!==null?h:(d!==t.namespaces&&(d=t.namespaces,g=t.enabled(f)),g),set:m=>{h=m;}}),typeof t.init=="function"&&t.init(v),v}function r(f,l){let h=t(this.namespace+(typeof l>"u"?":":l)+f);return h.log=this.log,h}function i(f){t.save(f),t.namespaces=f,t.names=[],t.skips=[];let l=(typeof f=="string"?f:"").trim().replace(/\s+/g,",").split(",").filter(Boolean);for(let h of l)h[0]==="-"?t.skips.push(h.slice(1)):t.names.push(h);}function n(f,l){let h=0,d=0,g=-1,v=0;for(;h<f.length;)if(d<l.length&&(l[d]===f[h]||l[d]==="*"))l[d]==="*"?(g=d,v=h,d++):(h++,d++);else if(g!==-1)d=g+1,v++,h=v;else return  false;for(;d<l.length&&l[d]==="*";)d++;return d===l.length}function o(){let f=[...t.names,...t.skips.map(l=>"-"+l)].join(",");return t.enable(""),f}function c(f){for(let l of t.skips)if(n(f,l))return  false;for(let l of t.names)if(n(f,l))return  true;return  false}function a(f){return f instanceof Error?f.stack||f.message:f}function u(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.");}return t.enable(t.load()),t}fr.exports=co;});var hr=p((M,Qe)=>{M.formatArgs=uo;M.save=fo;M.load=ho;M.useColors=lo;M.storage=po();M.destroy=(()=>{let s=false;return ()=>{s||(s=true,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."));}})();M.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function lo(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return  true;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return  false;let s;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(s=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(s[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function uo(s){if(s[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+s[0]+(this.useColors?"%c ":" ")+"+"+Qe.exports.humanize(this.diff),!this.useColors)return;let e="color: "+this.color;s.splice(1,0,e,"color: inherit");let t=0,r=0;s[0].replace(/%[a-zA-Z%]/g,i=>{i!=="%%"&&(t++,i==="%c"&&(r=t));}),s.splice(r,0,e);}M.log=console.debug||console.log||(()=>{});function fo(s){try{s?M.storage.setItem("debug",s):M.storage.removeItem("debug");}catch{}}function ho(){let s;try{s=M.storage.getItem("debug")||M.storage.getItem("DEBUG");}catch{}return !s&&typeof process<"u"&&"env"in process&&(s=process.env.DEBUG),s}function po(){try{return localStorage}catch{}}Qe.exports=vt()(M);var{formatters:yo}=Qe.exports;yo.j=function(s){try{return JSON.stringify(s)}catch(e){return "[UnexpectedJSONParseError]: "+e.message}};});var pr=p((Il,dr)=>{dr.exports=(s,e=process.argv)=>{let t=s.startsWith("-")?"":s.length===1?"-":"--",r=e.indexOf(t+s),i=e.indexOf("--");return r!==-1&&(i===-1||r<i)};});var mr=p((Pl,gr)=>{var go=k("os"),yr=k("tty"),I=pr(),{env:w}=process,Y;I("no-color")||I("no-colors")||I("color=false")||I("color=never")?Y=0:(I("color")||I("colors")||I("color=true")||I("color=always"))&&(Y=1);"FORCE_COLOR"in w&&(w.FORCE_COLOR==="true"?Y=1:w.FORCE_COLOR==="false"?Y=0:Y=w.FORCE_COLOR.length===0?1:Math.min(parseInt(w.FORCE_COLOR,10),3));function wt(s){return s===0?false:{level:s,hasBasic:true,has256:s>=2,has16m:s>=3}}function Et(s,e){if(Y===0)return 0;if(I("color=16m")||I("color=full")||I("color=truecolor"))return 3;if(I("color=256"))return 2;if(s&&!e&&Y===void 0)return 0;let t=Y||0;if(w.TERM==="dumb")return t;if(process.platform==="win32"){let r=go.release().split(".");return Number(r[0])>=10&&Number(r[2])>=10586?Number(r[2])>=14931?3:2:1}if("CI"in w)return ["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","GITHUB_ACTIONS","BUILDKITE"].some(r=>r in w)||w.CI_NAME==="codeship"?1:t;if("TEAMCITY_VERSION"in w)return /^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(w.TEAMCITY_VERSION)?1:0;if(w.COLORTERM==="truecolor")return 3;if("TERM_PROGRAM"in w){let r=parseInt((w.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(w.TERM_PROGRAM){case "iTerm.app":return r>=3?3:2;case "Apple_Terminal":return 2}}return /-256(color)?$/i.test(w.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(w.TERM)||"COLORTERM"in w?1:t}function mo(s){let e=Et(s,s&&s.isTTY);return wt(e)}gr.exports={supportsColor:mo,stdout:wt(Et(true,yr.isatty(1))),stderr:wt(Et(true,yr.isatty(2)))};});var Sr=p((E,Ge)=>{var bo=k("tty"),ze=k("util");E.init=Eo;E.log=_o;E.formatArgs=ko;E.save=vo;E.load=wo;E.useColors=So;E.destroy=ze.deprecate(()=>{},"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.");E.colors=[6,2,3,4,5,1];try{let s=mr();s&&(s.stderr||s).level>=2&&(E.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221]);}catch{}E.inspectOpts=Object.keys(process.env).filter(s=>/^debug_/i.test(s)).reduce((s,e)=>{let t=e.substring(6).toLowerCase().replace(/_([a-z])/g,(i,n)=>n.toUpperCase()),r=process.env[e];return /^(yes|on|true|enabled)$/i.test(r)?r=true:/^(no|off|false|disabled)$/i.test(r)?r=false:r==="null"?r=null:r=Number(r),s[t]=r,s},{});function So(){return "colors"in E.inspectOpts?!!E.inspectOpts.colors:bo.isatty(process.stderr.fd)}function ko(s){let{namespace:e,useColors:t}=this;if(t){let r=this.color,i="\x1B[3"+(r<8?r:"8;5;"+r),n=`  ${i};1m${e} \x1B[0m`;s[0]=n+s[0].split(`
`).join(`
`+n),s.push(i+"m+"+Ge.exports.humanize(this.diff)+"\x1B[0m");}else s[0]=Co()+e+" "+s[0];}function Co(){return E.inspectOpts.hideDate?"":new Date().toISOString()+" "}function _o(...s){return process.stderr.write(ze.formatWithOptions(E.inspectOpts,...s)+`
`)}function vo(s){s?process.env.DEBUG=s:delete process.env.DEBUG;}function wo(){return process.env.DEBUG}function Eo(s){s.inspectOpts={};let e=Object.keys(E.inspectOpts);for(let t=0;t<e.length;t++)s.inspectOpts[e[t]]=E.inspectOpts[e[t]];}Ge.exports=vt()(E);var{formatters:br}=Ge.exports;br.o=function(s){return this.inspectOpts.colors=this.useColors,ze.inspect(s,this.inspectOpts).split(`
`).map(e=>e.trim()).join(" ")};br.O=function(s){return this.inspectOpts.colors=this.useColors,ze.inspect(s,this.inspectOpts)};});var kr=p((Fl,xt)=>{typeof process>"u"||process.type==="renderer"||process.browser===true||process.__nwjs?xt.exports=hr():xt.exports=Sr();});var vr=p(L=>{Object.defineProperty(L,"__esModule",{value:true});L.genRedactedString=L.getStringValue=L.MAX_ARGUMENT_LENGTH=void 0;var xo=kr(),At=200;L.MAX_ARGUMENT_LENGTH=At;var Ao="ioredis";function Cr(s){if(s!==null)switch(typeof s){case "boolean":return;case "number":return;case "object":if(Buffer.isBuffer(s))return s.toString("hex");if(Array.isArray(s))return s.join(",");try{return JSON.stringify(s)}catch{return}case "string":return s}}L.getStringValue=Cr;function _r(s,e){let{length:t}=s;return t<=e?s:s.slice(0,e)+' ... <REDACTED full-length="'+t+'">'}L.genRedactedString=_r;function To(s){let e=(0, xo.default)(`${Ao}:${s}`);function t(...r){if(e.enabled){for(let i=1;i<r.length;i++){let n=Cr(r[i]);typeof n=="string"&&n.length>At&&(r[i]=_r(n,At));}return e.apply(null,r)}}return Object.defineProperties(t,{namespace:{get(){return e.namespace}},enabled:{get(){return e.enabled}},destroy:{get(){return e.destroy}},log:{get(){return e.log},set(r){e.log=r;}}}),t}L.default=To;});var Er=p(Tt=>{Object.defineProperty(Tt,"__esModule",{value:true});var wr=`-----BEGIN CERTIFICATE-----
MIIDTzCCAjegAwIBAgIJAKSVpiDswLcwMA0GCSqGSIb3DQEBBQUAMD4xFjAUBgNV
BAoMDUdhcmFudGlhIERhdGExJDAiBgNVBAMMG1NTTCBDZXJ0aWZpY2F0aW9uIEF1
dGhvcml0eTAeFw0xMzEwMDExMjE0NTVaFw0yMzA5MjkxMjE0NTVaMD4xFjAUBgNV
BAoMDUdhcmFudGlhIERhdGExJDAiBgNVBAMMG1NTTCBDZXJ0aWZpY2F0aW9uIEF1
dGhvcml0eTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBALZqkh/DczWP
JnxnHLQ7QL0T4B4CDKWBKCcisriGbA6ZePWVNo4hfKQC6JrzfR+081NeD6VcWUiz
rmd+jtPhIY4c+WVQYm5PKaN6DT1imYdxQw7aqO5j2KUCEh/cznpLxeSHoTxlR34E
QwF28Wl3eg2vc5ct8LjU3eozWVk3gb7alx9mSA2SgmuX5lEQawl++rSjsBStemY2
BDwOpAMXIrdEyP/cVn8mkvi/BDs5M5G+09j0gfhyCzRWMQ7Hn71u1eolRxwVxgi3
TMn+/vTaFSqxKjgck6zuAYjBRPaHe7qLxHNr1So/Mc9nPy+3wHebFwbIcnUojwbp
4nctkWbjb2cCAwEAAaNQME4wHQYDVR0OBBYEFP1whtcrydmW3ZJeuSoKZIKjze3w
MB8GA1UdIwQYMBaAFP1whtcrydmW3ZJeuSoKZIKjze3wMAwGA1UdEwQFMAMBAf8w
DQYJKoZIhvcNAQEFBQADggEBAG2erXhwRAa7+ZOBs0B6X57Hwyd1R4kfmXcs0rta
lbPpvgULSiB+TCbf3EbhJnHGyvdCY1tvlffLjdA7HJ0PCOn+YYLBA0pTU/dyvrN6
Su8NuS5yubnt9mb13nDGYo1rnt0YRfxN+8DM3fXIVr038A30UlPX2Ou1ExFJT0MZ
uFKY6ZvLdI6/1cbgmguMlAhM+DhKyV6Sr5699LM3zqeI816pZmlREETYkGr91q7k
BpXJu/dtHaGxg1ZGu6w/PCsYGUcECWENYD4VQPd8N32JjOfu6vEgoEAwfPP+3oGp
Z4m3ewACcWOAenqflb+cQYC4PsF7qbXDmRaWrbKntOlZ3n0=
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
MIIGMTCCBBmgAwIBAgICEAAwDQYJKoZIhvcNAQELBQAwajELMAkGA1UEBhMCVVMx
CzAJBgNVBAgMAkNBMQswCQYDVQQHDAJDQTESMBAGA1UECgwJUmVkaXNMYWJzMS0w
KwYDVQQDDCRSZWRpc0xhYnMgUm9vdCBDZXJ0aWZpY2F0ZSBBdXRob3JpdHkwHhcN
MTgwMjI1MTUzNzM3WhcNMjgwMjIzMTUzNzM3WjBfMQswCQYDVQQGEwJVUzELMAkG
A1UECAwCQ0ExEjAQBgNVBAoMCVJlZGlzTGFiczEvMC0GA1UEAwwmUkNQIEludGVy
bWVkaWF0ZSBDZXJ0aWZpY2F0ZSBBdXRob3JpdHkwggIiMA0GCSqGSIb3DQEBAQUA
A4ICDwAwggIKAoICAQDf9dqbxc8Bq7Ctq9rWcxrGNKKHivqLAFpPq02yLPx6fsOv
Tq7GsDChAYBBc4v7Y2Ap9RD5Vs3dIhEANcnolf27QwrG9RMnnvzk8pCvp1o6zSU4
VuOE1W66/O1/7e2rVxyrnTcP7UgK43zNIXu7+tiAqWsO92uSnuMoGPGpeaUm1jym
hjWKtkAwDFSqvHY+XL5qDVBEjeUe+WHkYUg40cAXjusAqgm2hZt29c2wnVrxW25W
P0meNlzHGFdA2AC5z54iRiqj57dTfBTkHoBczQxcyw6hhzxZQ4e5I5zOKjXXEhZN
r0tA3YC14CTabKRus/JmZieyZzRgEy2oti64tmLYTqSlAD78pRL40VNoaSYetXLw
hhNsXCHgWaY6d5bLOc/aIQMAV5oLvZQKvuXAF1IDmhPA+bZbpWipp0zagf1P1H3s
UzsMdn2KM0ejzgotbtNlj5TcrVwpmvE3ktvUAuA+hi3FkVx1US+2Gsp5x4YOzJ7u
P1WPk6ShF0JgnJH2ILdj6kttTWwFzH17keSFICWDfH/+kM+k7Y1v3EXMQXE7y0T9
MjvJskz6d/nv+sQhY04xt64xFMGTnZjlJMzfQNi7zWFLTZnDD0lPowq7l3YiPoTT
t5Xky83lu0KZsZBo0WlWaDG00gLVdtRgVbcuSWxpi5BdLb1kRab66JptWjxwXQID
AQABo4HrMIHoMDoGA1UdHwQzMDEwL6AtoCuGKWh0dHBzOi8vcmwtY2Etc2VydmVy
LnJlZGlzbGFicy5jb20vdjEvY3JsMEYGCCsGAQUFBwEBBDowODA2BggrBgEFBQcw
AYYqaHR0cHM6Ly9ybC1jYS1zZXJ2ZXIucmVkaXNsYWJzLmNvbS92MS9vY3NwMB0G
A1UdDgQWBBQHar5OKvQUpP2qWt6mckzToeCOHDAfBgNVHSMEGDAWgBQi42wH6hM4
L2sujEvLM0/u8lRXTzASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIB
hjANBgkqhkiG9w0BAQsFAAOCAgEAirEn/iTsAKyhd+pu2W3Z5NjCko4NPU0EYUbr
AP7+POK2rzjIrJO3nFYQ/LLuC7KCXG+2qwan2SAOGmqWst13Y+WHp44Kae0kaChW
vcYLXXSoGQGC8QuFSNUdaeg3RbMDYFT04dOkqufeWVccoHVxyTSg9eD8LZuHn5jw
7QDLiEECBmIJHk5Eeo2TAZrx4Yx6ufSUX5HeVjlAzqwtAqdt99uCJ/EL8bgpWbe+
XoSpvUv0SEC1I1dCAhCKAvRlIOA6VBcmzg5Am12KzkqTul12/VEFIgzqu0Zy2Jbc
AUPrYVu/+tOGXQaijy7YgwH8P8n3s7ZeUa1VABJHcxrxYduDDJBLZi+MjheUDaZ1
jQRHYevI2tlqeSBqdPKG4zBY5lS0GiAlmuze5oENt0P3XboHoZPHiqcK3VECgTVh
/BkJcuudETSJcZDmQ8YfoKfBzRQNg2sv/hwvUv73Ss51Sco8GEt2lD8uEdib1Q6z
zDT5lXJowSzOD5ZA9OGDjnSRL+2riNtKWKEqvtEG3VBJoBzu9GoxbAc7wIZLxmli
iF5a/Zf5X+UXD3s4TMmy6C4QZJpAA2egsSQCnraWO2ULhh7iXMysSkF/nzVfZn43
iqpaB8++9a37hWq14ZmOv0TJIDz//b2+KC4VFXWQ5W5QC6whsjT+OlG4p5ZYG0jo
616pxqo=
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
MIIFujCCA6KgAwIBAgIJAJ1aTT1lu2ScMA0GCSqGSIb3DQEBCwUAMGoxCzAJBgNV
BAYTAlVTMQswCQYDVQQIDAJDQTELMAkGA1UEBwwCQ0ExEjAQBgNVBAoMCVJlZGlz
TGFiczEtMCsGA1UEAwwkUmVkaXNMYWJzIFJvb3QgQ2VydGlmaWNhdGUgQXV0aG9y
aXR5MB4XDTE4MDIyNTE1MjA0MloXDTM4MDIyMDE1MjA0MlowajELMAkGA1UEBhMC
VVMxCzAJBgNVBAgMAkNBMQswCQYDVQQHDAJDQTESMBAGA1UECgwJUmVkaXNMYWJz
MS0wKwYDVQQDDCRSZWRpc0xhYnMgUm9vdCBDZXJ0aWZpY2F0ZSBBdXRob3JpdHkw
ggIiMA0GCSqGSIb3DQEBAQUAA4ICDwAwggIKAoICAQDLEjXy7YrbN5Waau5cd6g1
G5C2tMmeTpZ0duFAPxNU4oE3RHS5gGiok346fUXuUxbZ6QkuzeN2/2Z+RmRcJhQY
Dm0ZgdG4x59An1TJfnzKKoWj8ISmoHS/TGNBdFzXV7FYNLBuqZouqePI6ReC6Qhl
pp45huV32Q3a6IDrrvx7Wo5ZczEQeFNbCeCOQYNDdTmCyEkHqc2AGo8eoIlSTutT
ULOC7R5gzJVTS0e1hesQ7jmqHjbO+VQS1NAL4/5K6cuTEqUl+XhVhPdLWBXJQ5ag
54qhX4v+ojLzeU1R/Vc6NjMvVtptWY6JihpgplprN0Yh2556ewcXMeturcKgXfGJ
xeYzsjzXerEjrVocX5V8BNrg64NlifzTMKNOOv4fVZszq1SIHR8F9ROrqiOdh8iC
JpUbLpXH9hWCSEO6VRMB2xJoKu3cgl63kF30s77x7wLFMEHiwsQRKxooE1UhgS9K
2sO4TlQ1eWUvFvHSTVDQDlGQ6zu4qjbOpb3Q8bQwoK+ai2alkXVR4Ltxe9QlgYK3
StsnPhruzZGA0wbXdpw0bnM+YdlEm5ffSTpNIfgHeaa7Dtb801FtA71ZlH7A6TaI
SIQuUST9EKmv7xrJyx0W1pGoPOLw5T029aTjnICSLdtV9bLwysrLhIYG5bnPq78B
cS+jZHFGzD7PUVGQD01nOQIDAQABo2MwYTAdBgNVHQ4EFgQUIuNsB+oTOC9rLoxL
yzNP7vJUV08wHwYDVR0jBBgwFoAUIuNsB+oTOC9rLoxLyzNP7vJUV08wDwYDVR0T
AQH/BAUwAwEB/zAOBgNVHQ8BAf8EBAMCAYYwDQYJKoZIhvcNAQELBQADggIBAHfg
z5pMNUAKdMzK1aS1EDdK9yKz4qicILz5czSLj1mC7HKDRy8cVADUxEICis++CsCu
rYOvyCVergHQLREcxPq4rc5Nq1uj6J6649NEeh4WazOOjL4ZfQ1jVznMbGy+fJm3
3Hoelv6jWRG9iqeJZja7/1s6YC6bWymI/OY1e4wUKeNHAo+Vger7MlHV+RuabaX+
hSJ8bJAM59NCM7AgMTQpJCncrcdLeceYniGy5Q/qt2b5mJkQVkIdy4TPGGB+AXDJ
D0q3I/JDRkDUFNFdeW0js7fHdsvCR7O3tJy5zIgEV/o/BCkmJVtuwPYOrw/yOlKj
TY/U7ATAx9VFF6/vYEOMYSmrZlFX+98L6nJtwDqfLB5VTltqZ4H/KBxGE3IRSt9l
FXy40U+LnXzhhW+7VBAvyYX8GEXhHkKU8Gqk1xitrqfBXY74xKgyUSTolFSfFVgj
mcM/X4K45bka+qpkj7Kfv/8D4j6aZekwhN2ly6hhC1SmQ8qjMjpG/mrWOSSHZFmf
ybu9iD2AYHeIOkshIl6xYIa++Q/00/vs46IzAbQyriOi0XxlSMMVtPx0Q3isp+ji
n8Mq9eOuxYOEQ4of8twUkUDd528iwGtEdwf0Q01UyT84S62N8AySl1ZBKXJz6W4F
UhWfa/HQYOAPDdEjNgnVwLI23b8t0TozyCWw7q8h
-----END CERTIFICATE-----

-----BEGIN CERTIFICATE-----
MIIEjzCCA3egAwIBAgIQe55B/ALCKJDZtdNT8kD6hTANBgkqhkiG9w0BAQsFADBM
MSAwHgYDVQQLExdHbG9iYWxTaWduIFJvb3QgQ0EgLSBSMzETMBEGA1UEChMKR2xv
YmFsU2lnbjETMBEGA1UEAxMKR2xvYmFsU2lnbjAeFw0yMjAxMjYxMjAwMDBaFw0y
NTAxMjYwMDAwMDBaMFgxCzAJBgNVBAYTAkJFMRkwFwYDVQQKExBHbG9iYWxTaWdu
IG52LXNhMS4wLAYDVQQDEyVHbG9iYWxTaWduIEF0bGFzIFIzIE9WIFRMUyBDQSAy
MDIyIFEyMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAmGmg1LW9b7Lf
8zDD83yBDTEkt+FOxKJZqF4veWc5KZsQj9HfnUS2e5nj/E+JImlGPsQuoiosLuXD
BVBNAMcUFa11buFMGMeEMwiTmCXoXRrXQmH0qjpOfKgYc5gHG3BsRGaRrf7VR4eg
ofNMG9wUBw4/g/TT7+bQJdA4NfE7Y4d5gEryZiBGB/swaX6Jp/8MF4TgUmOWmalK
dZCKyb4sPGQFRTtElk67F7vU+wdGcrcOx1tDcIB0ncjLPMnaFicagl+daWGsKqTh
counQb6QJtYHa91KvCfKWocMxQ7OIbB5UARLPmC4CJ1/f8YFm35ebfzAeULYdGXu
jE9CLor0OwIDAQABo4IBXzCCAVswDgYDVR0PAQH/BAQDAgGGMB0GA1UdJQQWMBQG
CCsGAQUFBwMBBggrBgEFBQcDAjASBgNVHRMBAf8ECDAGAQH/AgEAMB0GA1UdDgQW
BBSH5Zq7a7B/t95GfJWkDBpA8HHqdjAfBgNVHSMEGDAWgBSP8Et/qC5FJK5NUPpj
move4t0bvDB7BggrBgEFBQcBAQRvMG0wLgYIKwYBBQUHMAGGImh0dHA6Ly9vY3Nw
Mi5nbG9iYWxzaWduLmNvbS9yb290cjMwOwYIKwYBBQUHMAKGL2h0dHA6Ly9zZWN1
cmUuZ2xvYmFsc2lnbi5jb20vY2FjZXJ0L3Jvb3QtcjMuY3J0MDYGA1UdHwQvMC0w
K6ApoCeGJWh0dHA6Ly9jcmwuZ2xvYmFsc2lnbi5jb20vcm9vdC1yMy5jcmwwIQYD
VR0gBBowGDAIBgZngQwBAgIwDAYKKwYBBAGgMgoBAjANBgkqhkiG9w0BAQsFAAOC
AQEAKRic9/f+nmhQU/wz04APZLjgG5OgsuUOyUEZjKVhNGDwxGTvKhyXGGAMW2B/
3bRi+aElpXwoxu3pL6fkElbX3B0BeS5LoDtxkyiVEBMZ8m+sXbocwlPyxrPbX6mY
0rVIvnuUeBH8X0L5IwfpNVvKnBIilTbcebfHyXkPezGwz7E1yhUULjJFm2bt0SdX
y+4X/WeiiYIv+fTVgZZgl+/2MKIsu/qdBJc3f3TvJ8nz+Eax1zgZmww+RSQWeOj3
15Iw6Z5FX+NwzY/Ab+9PosR5UosSeq+9HhtaxZttXG1nVh+avYPGYddWmiMT90J5
ZgKnO/Fx2hBgTxhOTMYaD312kg==
-----END CERTIFICATE-----

-----BEGIN CERTIFICATE-----
MIIDXzCCAkegAwIBAgILBAAAAAABIVhTCKIwDQYJKoZIhvcNAQELBQAwTDEgMB4G
A1UECxMXR2xvYmFsU2lnbiBSb290IENBIC0gUjMxEzARBgNVBAoTCkdsb2JhbFNp
Z24xEzARBgNVBAMTCkdsb2JhbFNpZ24wHhcNMDkwMzE4MTAwMDAwWhcNMjkwMzE4
MTAwMDAwWjBMMSAwHgYDVQQLExdHbG9iYWxTaWduIFJvb3QgQ0EgLSBSMzETMBEG
A1UEChMKR2xvYmFsU2lnbjETMBEGA1UEAxMKR2xvYmFsU2lnbjCCASIwDQYJKoZI
hvcNAQEBBQADggEPADCCAQoCggEBAMwldpB5BngiFvXAg7aEyiie/QV2EcWtiHL8
RgJDx7KKnQRfJMsuS+FggkbhUqsMgUdwbN1k0ev1LKMPgj0MK66X17YUhhB5uzsT
gHeMCOFJ0mpiLx9e+pZo34knlTifBtc+ycsmWQ1z3rDI6SYOgxXG71uL0gRgykmm
KPZpO/bLyCiR5Z2KYVc3rHQU3HTgOu5yLy6c+9C7v/U9AOEGM+iCK65TpjoWc4zd
QQ4gOsC0p6Hpsk+QLjJg6VfLuQSSaGjlOCZgdbKfd/+RFO+uIEn8rUAVSNECMWEZ
XriX7613t2Saer9fwRPvm2L7DWzgVGkWqQPabumDk3F2xmmFghcCAwEAAaNCMEAw
DgYDVR0PAQH/BAQDAgEGMA8GA1UdEwEB/wQFMAMBAf8wHQYDVR0OBBYEFI/wS3+o
LkUkrk1Q+mOai97i3Ru8MA0GCSqGSIb3DQEBCwUAA4IBAQBLQNvAUKr+yAzv95ZU
RUm7lgAJQayzE4aGKAczymvmdLm6AC2upArT9fHxD4q/c2dKg8dEe3jgr25sbwMp
jjM5RcOO5LlXbKr8EpbsU8Yt5CRsuZRj+9xTaGdWPoO4zzUhw8lo/s7awlOqzJCK
6fBdRoyV3XpYKBovHd7NADdBj+1EbddTKJd+82cEHhXXipa0095MJ6RMG3NzdvQX
mcIfeg7jLQitChws/zyrVQ4PkX4268NXSb7hLi18YIvDQVETI53O9zJrlAGomecs
Mx86OyXShkDOOyyGeMlhLxS67ttVb9+E7gUJTb0o2HLO02JQZR7rkpeDMdmztcpH
WD9f
-----END CERTIFICATE-----`,Oo={RedisCloudFixed:{ca:wr},RedisCloudFlexible:{ca:wr}};Tt.default=Oo;});var x=p(y=>{Object.defineProperty(y,"__esModule",{value:true});y.noop=y.defaults=y.Debug=y.getPackageMeta=y.zipMap=y.CONNECTION_CLOSED_ERROR_MSG=y.shuffle=y.sample=y.resolveTLSProfile=y.parseURL=y.optimizeErrorStack=y.toArg=y.convertMapToArray=y.convertObjectToArray=y.timeout=y.packObject=y.isInt=y.wrapMultiResult=y.convertBufferToString=void 0;var Mo=k("fs"),Ro=k("path"),xr=k("url"),Ot=je();Object.defineProperty(y,"defaults",{enumerable:true,get:function(){return Ot.defaults}});Object.defineProperty(y,"noop",{enumerable:true,get:function(){return Ot.noop}});var Bo=vr();y.Debug=Bo.default;var Io=Er();function Ar(s,e){if(s instanceof Buffer)return s.toString(e);if(Array.isArray(s)){let t=s.length,r=Array(t);for(let i=0;i<t;++i)r[i]=s[i]instanceof Buffer&&e==="utf8"?s[i].toString():Ar(s[i],e);return r}return s}y.convertBufferToString=Ar;function Po(s){if(!s)return null;let e=[],t=s.length;for(let r=0;r<t;++r){let i=s[r];i instanceof Error?e.push([i]):e.push([null,i]);}return e}y.wrapMultiResult=Po;function Tr(s){let e=parseFloat(s);return !isNaN(s)&&(e|0)===e}y.isInt=Tr;function Fo(s){let e={},t=s.length;for(let r=1;r<t;r+=2)e[s[r-1]]=s[r];return e}y.packObject=Fo;function Do(s,e){let t=null,r=function(){t&&(clearTimeout(t),t=null,s.apply(this,arguments));};return t=setTimeout(r,e,new Error("timeout")),r}y.timeout=Do;function No(s){let e=[],t=Object.keys(s);for(let r=0,i=t.length;r<i;r++)e.push(t[r],s[t[r]]);return e}y.convertObjectToArray=No;function qo(s){let e=[],t=0;return s.forEach(function(r,i){e[t]=i,e[t+1]=r,t+=2;}),e}y.convertMapToArray=qo;function jo(s){return s===null||typeof s>"u"?"":String(s)}y.toArg=jo;function Lo(s,e,t){let r=e.split(`
`),i="",n;for(n=1;n<r.length&&r[n].indexOf(t)!==-1;++n);for(let o=n;o<r.length;++o)i+=`
`+r[o];if(s.stack){let o=s.stack.indexOf(`
`);s.stack=s.stack.slice(0,o)+i;}return s}y.optimizeErrorStack=Lo;function Qo(s){if(Tr(s))return {port:s};let e=(0, xr.parse)(s,true,true);!e.slashes&&s[0]!=="/"&&(s="//"+s,e=(0, xr.parse)(s,true,true));let t=e.query||{},r={};if(e.auth){let i=e.auth.indexOf(":");r.username=i===-1?e.auth:e.auth.slice(0,i),r.password=i===-1?"":e.auth.slice(i+1);}if(e.pathname&&(e.protocol==="redis:"||e.protocol==="rediss:"?e.pathname.length>1&&(r.db=e.pathname.slice(1)):r.path=e.pathname),e.host&&(r.host=e.hostname),e.port&&(r.port=e.port),typeof t.family=="string"){let i=Number.parseInt(t.family,10);Number.isNaN(i)||(r.family=i);}return (0, Ot.defaults)(r,t),r}y.parseURL=Qo;function zo(s){let e=s?.tls;typeof e=="string"&&(e={profile:e});let t=Io.default[e?.profile];return t&&(e=Object.assign({},t,e),delete e.profile,s=Object.assign({},s,{tls:e})),s}y.resolveTLSProfile=zo;function Go(s,e=0){let t=s.length;return e>=t?null:s[e+Math.floor(Math.random()*(t-e))]}y.sample=Go;function Uo(s){let e=s.length;for(;e>0;){let t=Math.floor(Math.random()*e);e--,[s[e],s[t]]=[s[t],s[e]];}return s}y.shuffle=Uo;y.CONNECTION_CLOSED_ERROR_MSG="Connection is closed.";function Ko(s,e){let t=new Map;return s.forEach((r,i)=>{t.set(r,e[i]);}),t}y.zipMap=Ko;var pe=null;async function Vo(){if(pe)return pe;try{let s=(0,Ro.resolve)(__dirname,"..","..","package.json"),e=await Mo.promises.readFile(s,"utf8");return pe={version:JSON.parse(e).version},pe}catch{return pe={version:"error-fetching-version"},pe}}y.getPackageMeta=Vo;});var Or=p(ye=>{Object.defineProperty(ye,"__esModule",{value:true});ye.parseBlockOption=ye.parseSecondsArgument=void 0;var Mt=s=>{if(typeof s=="number")return s;if(Buffer.isBuffer(s))return Mt(s.toString());if(typeof s=="string"){let e=Number(s);return Number.isFinite(e)?e:void 0}},Yo=s=>{if(typeof s=="string")return s;if(Buffer.isBuffer(s))return s.toString()},Ho=s=>{let e=Mt(s);if(e!==void 0)return e<=0?0:e*1e3};ye.parseSecondsArgument=Ho;var Wo=s=>{for(let e=0;e<s.length;e++){let t=Yo(s[e]);if(t&&t.toLowerCase()==="block"){let r=Mt(s[e+1]);return r===void 0?void 0:r<=0?0:r}}return null};ye.parseBlockOption=Wo;});var Q=p(It=>{Object.defineProperty(It,"__esModule",{value:true});var Mr=ae(),Jo=we(),Xo=K(),ie=x(),Rt=Or(),N=class s{constructor(e,t=[],r={},i){if(this.name=e,this.inTransaction=false,this.isResolved=false,this.transformed=false,this.replyEncoding=r.replyEncoding,this.errorStack=r.errorStack,this.args=t.flat(),this.callback=i,this.initPromise(),r.keyPrefix){let n=r.keyPrefix instanceof Buffer,o=n?r.keyPrefix:null;this._iterateKeys(c=>c instanceof Buffer?(o===null&&(o=Buffer.from(r.keyPrefix)),Buffer.concat([o,c])):n?Buffer.concat([r.keyPrefix,Buffer.from(String(c))]):r.keyPrefix+c);}r.readOnly&&(this.isReadOnly=true);}static checkFlag(e,t){return t=t.toLowerCase(),!!this.getFlagMap()[e][t]}static setArgumentTransformer(e,t){this._transformer.argument[e]=t;}static setReplyTransformer(e,t){this._transformer.reply[e]=t;}static getFlagMap(){return this.flagMap||(this.flagMap=Object.keys(s.FLAGS).reduce((e,t)=>(e[t]={},s.FLAGS[t].forEach(r=>{e[t][r]=true;}),e),{})),this.flagMap}getSlot(){if(typeof this.slot>"u"){let e=this.getKeys()[0];this.slot=e==null?null:Jo(e);}return this.slot}getKeys(){return this._iterateKeys()}toWritable(e){let t,r="*"+(this.args.length+1)+`\r
$`+Buffer.byteLength(this.name)+`\r
`+this.name+`\r
`;if(this.bufferMode){let i=new Bt;i.push(r);for(let n=0;n<this.args.length;++n){let o=this.args[n];o instanceof Buffer?o.length===0?i.push(`$0\r
\r
`):(i.push("$"+o.length+`\r
`),i.push(o),i.push(`\r
`)):i.push("$"+Buffer.byteLength(o)+`\r
`+o+`\r
`);}t=i.toBuffer();}else {t=r;for(let i=0;i<this.args.length;++i){let n=this.args[i];t+="$"+Buffer.byteLength(n)+`\r
`+n+`\r
`;}}return t}stringifyArguments(){for(let e=0;e<this.args.length;++e){let t=this.args[e];typeof t=="string"||(t instanceof Buffer?this.bufferMode=true:this.args[e]=(0, ie.toArg)(t));}}transformReply(e){this.replyEncoding&&(e=(0, ie.convertBufferToString)(e,this.replyEncoding));let t=s._transformer.reply[this.name];return t&&(e=t(e)),e}setTimeout(e){this._commandTimeoutTimer||(this._commandTimeoutTimer=setTimeout(()=>{this.isResolved||this.reject(new Error("Command timed out"));},e));}setBlockingTimeout(e){if(e<=0)return;this._blockingTimeoutTimer&&(clearTimeout(this._blockingTimeoutTimer),this._blockingTimeoutTimer=void 0);let t=Date.now();this._blockingDeadline===void 0&&(this._blockingDeadline=t+e);let r=this._blockingDeadline-t;if(r<=0){this.resolve(null);return}this._blockingTimeoutTimer=setTimeout(()=>{if(this.isResolved){this._blockingTimeoutTimer=void 0;return}this._blockingTimeoutTimer=void 0,this.resolve(null);},r);}extractBlockingTimeout(){let e=this.args;if(!e||e.length===0)return;let t=this.name.toLowerCase();if(s.checkFlag("LAST_ARG_TIMEOUT_COMMANDS",t))return (0, Rt.parseSecondsArgument)(e[e.length-1]);if(s.checkFlag("FIRST_ARG_TIMEOUT_COMMANDS",t))return (0, Rt.parseSecondsArgument)(e[0]);if(s.checkFlag("BLOCK_OPTION_COMMANDS",t))return (0, Rt.parseBlockOption)(e)}_clearTimers(){let e=this._commandTimeoutTimer;e&&(clearTimeout(e),delete this._commandTimeoutTimer);let t=this._blockingTimeoutTimer;t&&(clearTimeout(t),delete this._blockingTimeoutTimer);}initPromise(){let e=new Promise((t,r)=>{if(!this.transformed){this.transformed=true;let i=s._transformer.argument[this.name];i&&(this.args=i(this.args)),this.stringifyArguments();}this.resolve=this._convertValue(t),this.reject=i=>{this._clearTimers(),this.errorStack?r((0, ie.optimizeErrorStack)(i,this.errorStack.stack,__dirname)):r(i);};});this.promise=(0, Xo.default)(e,this.callback);}_iterateKeys(e=t=>t){if(typeof this.keys>"u"&&(this.keys=[],(0, Mr.exists)(this.name,{caseInsensitive:true}))){let t=(0, Mr.getKeyIndexes)(this.name,this.args,{nameCaseInsensitive:true});for(let r of t)this.args[r]=e(this.args[r]),this.keys.push(this.args[r]);}return this.keys}_convertValue(e){return t=>{try{this._clearTimers(),e(this.transformReply(t)),this.isResolved=!0;}catch(r){this.reject(r);}return this.promise}}};It.default=N;N.FLAGS={VALID_IN_SUBSCRIBER_MODE:["subscribe","psubscribe","unsubscribe","punsubscribe","ssubscribe","sunsubscribe","ping","quit"],VALID_IN_MONITOR_MODE:["monitor","auth"],ENTER_SUBSCRIBER_MODE:["subscribe","psubscribe","ssubscribe"],EXIT_SUBSCRIBER_MODE:["unsubscribe","punsubscribe","sunsubscribe"],WILL_DISCONNECT:["quit"],HANDSHAKE_COMMANDS:["auth","select","client","readonly","info"],IGNORE_RECONNECT_ON_ERROR:["client"],BLOCKING_COMMANDS:["blpop","brpop","brpoplpush","blmove","bzpopmin","bzpopmax","bzmpop","blmpop","xread","xreadgroup"],LAST_ARG_TIMEOUT_COMMANDS:["blpop","brpop","brpoplpush","blmove","bzpopmin","bzpopmax"],FIRST_ARG_TIMEOUT_COMMANDS:["bzmpop","blmpop"],BLOCK_OPTION_COMMANDS:["xread","xreadgroup"]};N._transformer={argument:{},reply:{}};var Rr=function(s){if(s.length===1){if(s[0]instanceof Map)return (0, ie.convertMapToArray)(s[0]);if(typeof s[0]=="object"&&s[0]!==null)return (0, ie.convertObjectToArray)(s[0])}return s},Br=function(s){if(s.length===2){if(s[1]instanceof Map)return [s[0]].concat((0, ie.convertMapToArray)(s[1]));if(typeof s[1]=="object"&&s[1]!==null)return [s[0]].concat((0, ie.convertObjectToArray)(s[1]))}return s};N.setArgumentTransformer("mset",Rr);N.setArgumentTransformer("msetnx",Rr);N.setArgumentTransformer("hset",Br);N.setArgumentTransformer("hmset",Br);N.setReplyTransformer("hgetall",function(s){if(Array.isArray(s)){let e={};for(let t=0;t<s.length;t+=2){let r=s[t],i=s[t+1];r in e?Object.defineProperty(e,r,{value:i,configurable:true,enumerable:true,writable:true}):e[r]=i;}return e}return s});var Bt=class{constructor(){this.length=0,this.items=[];}push(e){this.length+=Buffer.byteLength(e),this.items.push(e);}toBuffer(){let e=Buffer.allocUnsafe(this.length),t=0;for(let r of this.items){let i=Buffer.byteLength(r);Buffer.isBuffer(r)?r.copy(e,t):e.write(r,t,i),t+=i;}return e}};});var Ir=p(Pt=>{Object.defineProperty(Pt,"__esModule",{value:true});var Zo=se(),Ue=class extends Zo.RedisError{constructor(e,t){super(e),this.lastNodeError=t,Error.captureStackTrace(this,this.constructor);}get name(){return this.constructor.name}};Pt.default=Ue;Ue.defaultMessage="Failed to refresh slots cache.";});var Ke=p(Dt=>{Object.defineProperty(Dt,"__esModule",{value:true});var $o=k("stream"),Ft=class extends $o.Readable{constructor(e){super(e),this.opt=e,this._redisCursor="0",this._redisDrained=false;}_read(){if(this._redisDrained){this.push(null);return}let e=[this._redisCursor];this.opt.key&&e.unshift(this.opt.key),this.opt.match&&e.push("MATCH",this.opt.match),this.opt.type&&e.push("TYPE",this.opt.type),this.opt.count&&e.push("COUNT",String(this.opt.count)),this.opt.noValues&&e.push("NOVALUES"),this.opt.redis[this.opt.command](e,(t,r)=>{if(t){this.emit("error",t);return}this._redisCursor=r[0]instanceof Buffer?r[0].toString():r[0],this._redisCursor==="0"&&(this._redisDrained=true),this.push(r[1]);});}close(){this._redisDrained=true;}};Dt.default=Ft;});var jr=p(_=>{Object.defineProperty(_,"__esModule",{value:true});_.executeWithAutoPipelining=_.getFirstValueInFlattenedArray=_.shouldUseAutoPipelining=_.notAllowedAutoPipelineCommands=_.kCallbacks=_.kExec=void 0;var Fr=je(),ea=we(),Pr=K();_.kExec=Symbol("exec");_.kCallbacks=Symbol("callbacks");_.notAllowedAutoPipelineCommands=["auth","info","script","quit","cluster","pipeline","multi","subscribe","psubscribe","unsubscribe","unpsubscribe","select","client"];function Dr(s,e){if(s._runningAutoPipelines.has(e)||!s._autoPipelines.has(e))return;s._runningAutoPipelines.add(e);let t=s._autoPipelines.get(e);s._autoPipelines.delete(e);let r=t[_.kCallbacks];t[_.kCallbacks]=null,t.exec(function(i,n){if(s._runningAutoPipelines.delete(e),i)for(let o=0;o<r.length;o++)process.nextTick(r[o],i);else for(let o=0;o<r.length;o++)process.nextTick(r[o],...n[o]);s._autoPipelines.has(e)&&Dr(s,e);});}function ta(s,e,t){return e&&s.options.enableAutoPipelining&&!s.isPipeline&&!_.notAllowedAutoPipelineCommands.includes(t)&&!s.options.autoPipeliningIgnoredCommands.includes(t)}_.shouldUseAutoPipelining=ta;function Nr(s){for(let e=0;e<s.length;e++){let t=s[e];if(typeof t=="string")return t;if(Array.isArray(t)||(0, Fr.isArguments)(t)){if(t.length===0)continue;return t[0]}let r=[t].flat();if(r.length>0)return r[0]}}_.getFirstValueInFlattenedArray=Nr;function qr(s,e,t,r,i){if(s.isCluster&&!s.slots.length)return s.status==="wait"&&s.connect().catch(Fr.noop),(0, Pr.default)(new Promise(function(u,f){s.delayUntilReady(l=>{if(l){f(l);return}qr(s,e,t,r,null).then(u,f);});}),i);let n=s.options.keyPrefix||"",o=s.isCluster?s.slots[ea(`${n}${Nr(r)}`)].join(","):"main";if(!s._autoPipelines.has(o)){let u=s.pipeline();u[_.kExec]=false,u[_.kCallbacks]=[],s._autoPipelines.set(o,u);}let c=s._autoPipelines.get(o);c[_.kExec]||(c[_.kExec]=true,setImmediate(Dr,s,o));let a=new Promise(function(u,f){c[_.kCallbacks].push(function(l,h){if(l){f(l);return}u(h);}),e==="call"&&r.unshift(t),c[e](...r);});return (0, Pr.default)(a,i)}_.executeWithAutoPipelining=qr;});var Lr=p(qt=>{Object.defineProperty(qt,"__esModule",{value:true});var sa=k("crypto"),ra=Q(),ia=K(),Nt=class{constructor(e,t=null,r="",i=false){this.lua=e,this.numberOfKeys=t,this.keyPrefix=r,this.readOnly=i,this.sha=(0, sa.createHash)("sha1").update(e).digest("hex");let n=this.sha,o=new WeakSet;this.Command=class extends ra.default{toWritable(a){let u=this.reject;return this.reject=f=>{f.message.indexOf("NOSCRIPT")!==-1&&o.delete(a),u.call(this,f);},o.has(a)?this.name==="eval"&&(this.name="evalsha",this.args[0]=n):(o.add(a),this.name="eval",this.args[0]=e),super.toWritable(a)}};}execute(e,t,r,i){typeof this.numberOfKeys=="number"&&t.unshift(this.numberOfKeys),this.keyPrefix&&(r.keyPrefix=this.keyPrefix),this.readOnly&&(r.readOnly=true);let n=new this.Command("evalsha",[this.sha,...t],r);return n.promise=n.promise.catch(o=>{if(o.message.indexOf("NOSCRIPT")===-1)throw o;let c=new this.Command("evalsha",[this.sha,...t],r);return (e.isPipeline?e.redis:e).sendCommand(c)}),(0, ia.default)(n.promise,i),e.sendCommand(n)}};qt.default=Nt;});var Ye=p(Lt=>{Object.defineProperty(Lt,"__esModule",{value:true});var na=ae(),Ve=jr(),oa=Q(),aa=Lr(),z=class{constructor(){this.options={},this.scriptsSet={},this.addedBuiltinSet=new Set;}getBuiltinCommands(){return jt.slice(0)}createBuiltinCommand(e){return {string:H(null,e,"utf8"),buffer:H(null,e,null)}}addBuiltinCommand(e){this.addedBuiltinSet.add(e),this[e]=H(e,e,"utf8"),this[e+"Buffer"]=H(e+"Buffer",e,null);}defineCommand(e,t){let r=new aa.default(t.lua,t.numberOfKeys,this.options.keyPrefix,t.readOnly);this.scriptsSet[e]=r,this[e]=Qr(e,e,r,"utf8"),this[e+"Buffer"]=Qr(e+"Buffer",e,r,null);}sendCommand(e,t,r){throw new Error('"sendCommand" is not implemented')}},jt=na.list.filter(s=>s!=="monitor");jt.push("sentinel");jt.forEach(function(s){z.prototype[s]=H(s,s,"utf8"),z.prototype[s+"Buffer"]=H(s+"Buffer",s,null);});z.prototype.call=H("call","utf8");z.prototype.callBuffer=H("callBuffer",null);z.prototype.send_command=z.prototype.call;function H(s,e,t){return typeof t>"u"&&(t=e,e=null),function(...r){let i=e||r.shift(),n=r[r.length-1];typeof n=="function"?r.pop():n=void 0;let o={errorStack:this.options.showFriendlyErrorStack?new Error:void 0,keyPrefix:this.options.keyPrefix,replyEncoding:t};return (0, Ve.shouldUseAutoPipelining)(this,s,i)?(0, Ve.executeWithAutoPipelining)(this,s,i,r,n):this.sendCommand(new oa.default(i,r,o,n))}}function Qr(s,e,t,r){return function(...i){let n=typeof i[i.length-1]=="function"?i.pop():void 0,o={replyEncoding:r};return this.options.showFriendlyErrorStack&&(o.errorStack=new Error),(0, Ve.shouldUseAutoPipelining)(this,s,e)?(0, Ve.executeWithAutoPipelining)(this,s,e,i,n):t.execute(this,i,o,n)}}Lt.default=z;});var Gt=p(zt=>{Object.defineProperty(zt,"__esModule",{value:true});var Qt=we(),zr=ae(),Gr=K(),ca=k("util"),la=Q(),ua=x(),fa=Ye();function ha(s,e){let t=Qt(e[0]),r=s._groupsBySlot[t];for(let i=1;i<e.length;i++)if(s._groupsBySlot[Qt(e[i])]!==r)return  -1;return t}var W=class extends fa.default{constructor(e){super(),this.redis=e,this.isPipeline=true,this.replyPending=0,this._queue=[],this._result=[],this._transactions=0,this._shaToScript={},this.isCluster=this.redis.constructor.name==="Cluster"||this.redis.isCluster,this.options=e.options,Object.keys(e.scriptsSet).forEach(r=>{let i=e.scriptsSet[r];this._shaToScript[i.sha]=i,this[r]=e[r],this[r+"Buffer"]=e[r+"Buffer"];}),e.addedBuiltinSet.forEach(r=>{this[r]=e[r],this[r+"Buffer"]=e[r+"Buffer"];}),this.promise=new Promise((r,i)=>{this.resolve=r,this.reject=i;});let t=this;Object.defineProperty(this,"length",{get:function(){return t._queue.length}});}fillResult(e,t){if(this._queue[t].name==="exec"&&Array.isArray(e[1])){let i=e[1].length;for(let n=0;n<i;n++){if(e[1][n]instanceof Error)continue;let o=this._queue[t-(i-n)];try{e[1][n]=o.transformReply(e[1][n]);}catch(c){e[1][n]=c;}}}if(this._result[t]=e,--this.replyPending)return;if(this.isCluster){let i=true,n;for(let o=0;o<this._result.length;++o){let c=this._result[o][0],a=this._queue[o];if(c){if(a.name==="exec"&&c.message==="EXECABORT Transaction discarded because of previous errors.")continue;if(!n)n={name:c.name,message:c.message};else if(n.name!==c.name||n.message!==c.message){i=false;break}}else if(!a.inTransaction&&!((0, zr.exists)(a.name,{caseInsensitive:true})&&(0, zr.hasFlag)(a.name,"readonly",{nameCaseInsensitive:true}))){i=false;break}}if(n&&i){let o=this,c=n.message.split(" "),a=this._queue,u=false;this._queue=[];for(let d=0;d<a.length;++d){if(c[0]==="ASK"&&!u&&a[d].name!=="asking"&&(!a[d-1]||a[d-1].name!=="asking")){let g=new la.default("asking");g.ignore=true,this.sendCommand(g);}a[d].initPromise(),this.sendCommand(a[d]),u=a[d].inTransaction;}let f=true;typeof this.leftRedirections>"u"&&(this.leftRedirections={});let l=function(){o.exec();},h=this.redis;if(h.handleError(n,this.leftRedirections,{moved:function(d,g){o.preferKey=g,h.slots[c[1]]=[g],h._groupsBySlot[c[1]]=h._groupsIds[h.slots[c[1]].join(";")],h.refreshSlotsCache(),o.exec();},ask:function(d,g){o.preferKey=g,o.exec();},tryagain:l,clusterDown:l,connectionClosed:l,maxRedirections:()=>{f=false;},defaults:()=>{f=false;}}),f)return}}let r=0;for(let i=0;i<this._queue.length-r;++i)this._queue[i+r].ignore&&(r+=1),this._result[i]=this._result[i+r];this.resolve(this._result.slice(0,this._result.length-r));}sendCommand(e){this._transactions>0&&(e.inTransaction=true);let t=this._queue.length;return e.pipelineIndex=t,e.promise.then(r=>{this.fillResult([null,r],t);}).catch(r=>{this.fillResult([r],t);}),this._queue.push(e),this}addBatch(e){let t,r,i;for(let n=0;n<e.length;++n)t=e[n],r=t[0],i=t.slice(1),this[r].apply(this,i);return this}};zt.default=W;var da=W.prototype.multi;W.prototype.multi=function(){return this._transactions+=1,da.apply(this,arguments)};var Ur=W.prototype.execBuffer;W.prototype.execBuffer=(0, ca.deprecate)(function(){return this._transactions>0&&(this._transactions-=1),Ur.apply(this,arguments)},"Pipeline#execBuffer: Use Pipeline#exec instead");W.prototype.exec=function(s){if(this.isCluster&&!this.redis.slots.length)return this.redis.status==="wait"&&this.redis.connect().catch(ua.noop),s&&!this.nodeifiedPromise&&(this.nodeifiedPromise=true,(0, Gr.default)(this.promise,s)),this.redis.delayUntilReady(i=>{if(i){this.reject(i);return}this.exec(s);}),this.promise;if(this._transactions>0)return this._transactions-=1,Ur.apply(this,arguments);this.nodeifiedPromise||(this.nodeifiedPromise=true,(0, Gr.default)(this.promise,s)),this._queue.length||this.resolve([]);let e;if(this.isCluster){let i=[];for(let n=0;n<this._queue.length;n++){let o=this._queue[n].getKeys();if(o.length&&i.push(o[0]),o.length&&Qt.generateMulti(o)<0)return this.reject(new Error("All the keys in a pipeline command should belong to the same slot")),this.promise}if(i.length){if(e=ha(this.redis,i),e<0)return this.reject(new Error("All keys in the pipeline should belong to the same slots allocation group")),this.promise}else e=Math.random()*16384|0;}let t=this;return r(),this.promise;function r(){let i=t.replyPending=t._queue.length,n;t.isCluster&&(n={slot:e,redis:t.redis.connectionPool.nodes.all[t.preferKey]});let o="",c,a={isPipeline:true,destination:t.isCluster?n:{redis:t.redis},write(u){typeof u!="string"?(c||(c=[]),o&&(c.push(Buffer.from(o,"utf8")),o=""),c.push(u)):o+=u,--i||(c?(o&&c.push(Buffer.from(o,"utf8")),a.destination.redis.stream.write(Buffer.concat(c))):a.destination.redis.stream.write(o),i=t._queue.length,o="",c=void 0);}};for(let u=0;u<t._queue.length;++u)t.redis.sendCommand(t._queue[u],a,n);return t.promise}};});var Vt=p(He=>{Object.defineProperty(He,"__esModule",{value:true});He.addTransactionSupport=void 0;var Ut=x(),Kt=K(),Kr=Gt();function pa(s){s.pipeline=function(r){let i=new Kr.default(this);return Array.isArray(r)&&i.addBatch(r),i};let{multi:e}=s;s.multi=function(r,i){if(typeof i>"u"&&!Array.isArray(r)&&(i=r,r=null),i&&i.pipeline===false)return e.call(this);let n=new Kr.default(this);n.multi(),Array.isArray(r)&&n.addBatch(r);let o=n.exec;n.exec=function(a){if(this.isCluster&&!this.redis.slots.length)return this.redis.status==="wait"&&this.redis.connect().catch(Ut.noop),(0, Kt.default)(new Promise((f,l)=>{this.redis.delayUntilReady(h=>{if(h){l(h);return}this.exec(n).then(f,l);});}),a);if(this._transactions>0&&o.call(n),this.nodeifiedPromise)return o.call(n);let u=o.call(n);return (0, Kt.default)(u.then(function(f){let l=f[f.length-1];if(typeof l>"u")throw new Error("Pipeline cannot be used to send any commands when the `exec()` has been called on it.");if(l[0]){l[0].previousErrors=[];for(let h=0;h<f.length-1;++h)f[h][0]&&l[0].previousErrors.push(f[h][0]);throw l[0]}return (0, Ut.wrapMultiResult)(l[1])}),a)};let{execBuffer:c}=n;return n.execBuffer=function(a){return this._transactions>0&&c.call(n),n.exec(a)},n};let{exec:t}=s;s.exec=function(r){return (0, Kt.default)(t.call(this).then(function(i){return Array.isArray(i)&&(i=(0, Ut.wrapMultiResult)(i)),i}),r)};}He.addTransactionSupport=pa;});var Ht=p(Yt=>{Object.defineProperty(Yt,"__esModule",{value:true});function ya(s,e){Object.getOwnPropertyNames(e.prototype).forEach(t=>{Object.defineProperty(s.prototype,t,Object.getOwnPropertyDescriptor(e.prototype,t));});}Yt.default=ya;});var Yr=p(We=>{Object.defineProperty(We,"__esModule",{value:true});We.DEFAULT_CLUSTER_OPTIONS=void 0;var Vr=k("dns");We.DEFAULT_CLUSTER_OPTIONS={clusterRetryStrategy:s=>Math.min(100+s*2,2e3),enableOfflineQueue:true,enableReadyCheck:true,scaleReads:"master",maxRedirections:16,retryDelayOnMoved:0,retryDelayOnFailover:100,retryDelayOnClusterDown:100,retryDelayOnTryAgain:100,slotsRefreshTimeout:1e3,useSRVRecords:false,resolveSrv:Vr.resolveSrv,dnsLookup:Vr.lookup,enableAutoPipelining:false,autoPipeliningIgnoredCommands:[],shardedSubscribers:false};});var ge=p(T=>{Object.defineProperty(T,"__esModule",{value:true});T.getConnectionName=T.weightSrvRecords=T.groupSrvRecords=T.getUniqueHostnamesFromOptions=T.normalizeNodeOptions=T.nodeKeyToRedisOptions=T.getNodeKey=void 0;var Hr=x(),ga=k("net");function ma(s){return s.port=s.port||6379,s.host=s.host||"127.0.0.1",s.host+":"+s.port}T.getNodeKey=ma;function ba(s){let e=s.lastIndexOf(":");if(e===-1)throw new Error(`Invalid node key ${s}`);return {host:s.slice(0,e),port:Number(s.slice(e+1))}}T.nodeKeyToRedisOptions=ba;function Sa(s){return s.map(e=>{let t={};if(typeof e=="object")Object.assign(t,e);else if(typeof e=="string")Object.assign(t,(0, Hr.parseURL)(e));else if(typeof e=="number")t.port=e;else throw new Error("Invalid argument "+e);return typeof t.port=="string"&&(t.port=parseInt(t.port,10)),delete t.db,t.port||(t.port=6379),t.host||(t.host="127.0.0.1"),(0, Hr.resolveTLSProfile)(t)})}T.normalizeNodeOptions=Sa;function ka(s){let e={};return s.forEach(t=>{e[t.host]=true;}),Object.keys(e).filter(t=>!(0, ga.isIP)(t))}T.getUniqueHostnamesFromOptions=ka;function Ca(s){let e={};for(let t of s)e.hasOwnProperty(t.priority)?(e[t.priority].totalWeight+=t.weight,e[t.priority].records.push(t)):e[t.priority]={totalWeight:t.weight,records:[t]};return e}T.groupSrvRecords=Ca;function _a(s){if(s.records.length===1)return s.totalWeight=0,s.records.shift();let e=Math.floor(Math.random()*(s.totalWeight+s.records.length)),t=0;for(let[r,i]of s.records.entries())if(t+=1+i.weight,t>e)return s.totalWeight-=i.weight,s.records.splice(r,1),i}T.weightSrvRecords=_a;function va(s,e){let t=`ioredis-cluster(${s})`;return e?`${t}:${e}`:t}T.getConnectionName=va;});var Jr=p(Xt=>{Object.defineProperty(Xt,"__esModule",{value:true});var Wr=ge(),Wt=x(),wa=G(),q=(0, Wt.Debug)("cluster:subscriber"),Jt=class{constructor(e,t,r=false){this.connectionPool=e,this.emitter=t,this.isSharded=r,this.started=false,this.subscriber=null,this.slotRange=[],this.onSubscriberEnd=()=>{if(!this.started){q("subscriber has disconnected, but ClusterSubscriber is not started, so not reconnecting.");return}q("subscriber has disconnected, selecting a new one..."),this.selectSubscriber();},this.connectionPool.on("-node",(i,n)=>{!this.started||!this.subscriber||(0, Wr.getNodeKey)(this.subscriber.options)===n&&(q("subscriber has left, selecting a new one..."),this.selectSubscriber());}),this.connectionPool.on("+node",()=>{!this.started||this.subscriber||(q("a new node is discovered and there is no subscriber, selecting a new one..."),this.selectSubscriber());});}getInstance(){return this.subscriber}associateSlotRange(e){return this.isSharded&&(this.slotRange=e),this.slotRange}start(){this.started=true,this.selectSubscriber(),q("started");}stop(){this.started=false,this.subscriber&&(this.subscriber.disconnect(),this.subscriber=null);}isStarted(){return this.started}selectSubscriber(){let e=this.lastActiveSubscriber;e&&(e.off("end",this.onSubscriberEnd),e.disconnect()),this.subscriber&&(this.subscriber.off("end",this.onSubscriberEnd),this.subscriber.disconnect());let t=(0, Wt.sample)(this.connectionPool.getNodes());if(!t){q("selecting subscriber failed since there is no node discovered in the cluster yet"),this.subscriber=null;return}let{options:r}=t;q("selected a subscriber %s:%s",r.host,r.port);let i="subscriber";this.isSharded&&(i="ssubscriber"),this.subscriber=new wa.default({port:r.port,host:r.host,username:r.username,password:r.password,enableReadyCheck:true,connectionName:(0, Wr.getConnectionName)(i,r.connectionName),lazyConnect:true,tls:r.tls,retryStrategy:null}),this.subscriber.on("error",Wt.noop),this.subscriber.on("moved",()=>{this.emitter.emit("forceRefresh");}),this.subscriber.once("end",this.onSubscriberEnd);let n={subscribe:[],psubscribe:[],ssubscribe:[]};if(e){let o=e.condition||e.prevCondition;o&&o.subscriber&&(n.subscribe=o.subscriber.channels("subscribe"),n.psubscribe=o.subscriber.channels("psubscribe"),n.ssubscribe=o.subscriber.channels("ssubscribe"));}if(n.subscribe.length||n.psubscribe.length||n.ssubscribe.length){let o=0;for(let c of ["subscribe","psubscribe","ssubscribe"]){let a=n[c];if(a.length!=0)if(q("%s %d channels",c,a.length),c==="ssubscribe")for(let u of a)o+=1,this.subscriber[c](u).then(()=>{--o||(this.lastActiveSubscriber=this.subscriber);}).catch(()=>{q("failed to ssubscribe to channel: %s",u);});else o+=1,this.subscriber[c](a).then(()=>{--o||(this.lastActiveSubscriber=this.subscriber);}).catch(()=>{q("failed to %s %d channels",c,a.length);});}}else this.lastActiveSubscriber=this.subscriber;for(let o of ["message","messageBuffer"])this.subscriber.on(o,(c,a)=>{this.emitter.emit(o,c,a);});for(let o of ["pmessage","pmessageBuffer"])this.subscriber.on(o,(c,a,u)=>{this.emitter.emit(o,c,a,u);});if(this.isSharded==true)for(let o of ["smessage","smessageBuffer"])this.subscriber.on(o,(c,a)=>{this.emitter.emit(o,c,a);});}};Xt.default=Jt;});var Xr=p(es=>{Object.defineProperty(es,"__esModule",{value:true});var Ea=k("events"),Je=x(),Zt=ge(),xa=G(),Ae=(0, Je.Debug)("cluster:connectionPool"),$t=class extends Ea.EventEmitter{constructor(e){super(),this.redisOptions=e,this.nodes={all:{},master:{},slave:{}},this.specifiedOptions={};}getNodes(e="all"){let t=this.nodes[e];return Object.keys(t).map(r=>t[r])}getInstanceByKey(e){return this.nodes.all[e]}getSampleInstance(e){let t=Object.keys(this.nodes[e]),r=(0, Je.sample)(t);return this.nodes[e][r]}addMasterNode(e){let t=(0, Zt.getNodeKey)(e.options),r=this.createRedisFromOptions(e,e.options.readOnly);return e.options.readOnly?false:(this.nodes.all[t]=r,this.nodes.master[t]=r,true)}createRedisFromOptions(e,t){return new xa.default((0, Je.defaults)({retryStrategy:null,enableOfflineQueue:true,readOnly:t},e,this.redisOptions,{lazyConnect:true}))}findOrCreate(e,t=false){let r=(0, Zt.getNodeKey)(e);t=!!t,this.specifiedOptions[r]?Object.assign(e,this.specifiedOptions[r]):this.specifiedOptions[r]=e;let i;return this.nodes.all[r]?(i=this.nodes.all[r],i.options.readOnly!==t&&(i.options.readOnly=t,Ae("Change role of %s to %s",r,t?"slave":"master"),i[t?"readonly":"readwrite"]().catch(Je.noop),t?(delete this.nodes.master[r],this.nodes.slave[r]=i):(delete this.nodes.slave[r],this.nodes.master[r]=i))):(Ae("Connecting to %s as %s",r,t?"slave":"master"),i=this.createRedisFromOptions(e,t),this.nodes.all[r]=i,this.nodes[t?"slave":"master"][r]=i,i.once("end",()=>{this.removeNode(r),this.emit("-node",i,r),Object.keys(this.nodes.all).length||this.emit("drain");}),this.emit("+node",i,r),i.on("error",function(n){this.emit("nodeError",n,r);})),i}reset(e){Ae("Reset with %O",e);let t={};e.forEach(r=>{let i=(0, Zt.getNodeKey)(r);r.readOnly&&t[i]||(t[i]=r);}),Object.keys(this.nodes.all).forEach(r=>{t[r]||(Ae("Disconnect %s because the node does not hold any slot",r),this.nodes.all[r].disconnect(),this.removeNode(r));}),Object.keys(t).forEach(r=>{let i=t[r];this.findOrCreate(i,i.readOnly);});}removeNode(e){let{nodes:t}=this;t.all[e]&&(Ae("Remove %s from the pool",e),delete t.all[e]),delete t.master[e],delete t.slave[e];}};es.default=$t;});var Xe=p((eu,Zr)=>{function C(s,t){var t=t||{};this._capacity=t.capacity,this._head=0,this._tail=0,Array.isArray(s)?this._fromArray(s):(this._capacityMask=3,this._list=new Array(4));}C.prototype.peekAt=function(e){var t=e;if(t===(t|0)){var r=this.size();if(!(t>=r||t<-r))return t<0&&(t+=r),t=this._head+t&this._capacityMask,this._list[t]}};C.prototype.get=function(e){return this.peekAt(e)};C.prototype.peek=function(){if(this._head!==this._tail)return this._list[this._head]};C.prototype.peekFront=function(){return this.peek()};C.prototype.peekBack=function(){return this.peekAt(-1)};Object.defineProperty(C.prototype,"length",{get:function(){return this.size()}});C.prototype.size=function(){return this._head===this._tail?0:this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};C.prototype.unshift=function(e){if(arguments.length===0)return this.size();var t=this._list.length;return this._head=this._head-1+t&this._capacityMask,this._list[this._head]=e,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.pop(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};C.prototype.shift=function(){var e=this._head;if(e!==this._tail){var t=this._list[e];return this._list[e]=void 0,this._head=e+1&this._capacityMask,e<2&&this._tail>1e4&&this._tail<=this._list.length>>>2&&this._shrinkArray(),t}};C.prototype.push=function(e){if(arguments.length===0)return this.size();var t=this._tail;return this._list[t]=e,this._tail=t+1&this._capacityMask,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.shift(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};C.prototype.pop=function(){var e=this._tail;if(e!==this._head){var t=this._list.length;this._tail=e-1+t&this._capacityMask;var r=this._list[this._tail];return this._list[this._tail]=void 0,this._head<2&&e>1e4&&e<=t>>>2&&this._shrinkArray(),r}};C.prototype.removeOne=function(e){var t=e;if(t===(t|0)&&this._head!==this._tail){var r=this.size(),i=this._list.length;if(!(t>=r||t<-r)){t<0&&(t+=r),t=this._head+t&this._capacityMask;var n=this._list[t],o;if(e<r/2){for(o=e;o>0;o--)this._list[t]=this._list[t=t-1+i&this._capacityMask];this._list[t]=void 0,this._head=this._head+1+i&this._capacityMask;}else {for(o=r-1-e;o>0;o--)this._list[t]=this._list[t=t+1+i&this._capacityMask];this._list[t]=void 0,this._tail=this._tail-1+i&this._capacityMask;}return n}}};C.prototype.remove=function(e,t){var r=e,i,n=t;if(r===(r|0)&&this._head!==this._tail){var o=this.size(),c=this._list.length;if(!(r>=o||r<-o||t<1)){if(r<0&&(r+=o),t===1||!t)return i=new Array(1),i[0]=this.removeOne(r),i;if(r===0&&r+t>=o)return i=this.toArray(),this.clear(),i;r+t>o&&(t=o-r);var a;for(i=new Array(t),a=0;a<t;a++)i[a]=this._list[this._head+r+a&this._capacityMask];if(r=this._head+r&this._capacityMask,e+t===o){for(this._tail=this._tail-t+c&this._capacityMask,a=t;a>0;a--)this._list[r=r+1+c&this._capacityMask]=void 0;return i}if(e===0){for(this._head=this._head+t+c&this._capacityMask,a=t-1;a>0;a--)this._list[r=r+1+c&this._capacityMask]=void 0;return i}if(r<o/2){for(this._head=this._head+e+t+c&this._capacityMask,a=e;a>0;a--)this.unshift(this._list[r=r-1+c&this._capacityMask]);for(r=this._head-1+c&this._capacityMask;n>0;)this._list[r=r-1+c&this._capacityMask]=void 0,n--;e<0&&(this._tail=r);}else {for(this._tail=r,r=r+t+c&this._capacityMask,a=o-(t+e);a>0;a--)this.push(this._list[r++]);for(r=this._tail;n>0;)this._list[r=r+1+c&this._capacityMask]=void 0,n--;}return this._head<2&&this._tail>1e4&&this._tail<=c>>>2&&this._shrinkArray(),i}}};C.prototype.splice=function(e,t){var r=e;if(r===(r|0)){var i=this.size();if(r<0&&(r+=i),!(r>i))if(arguments.length>2){var n,o,c,a=arguments.length,u=this._list.length,f=2;if(!i||r<i/2){for(o=new Array(r),n=0;n<r;n++)o[n]=this._list[this._head+n&this._capacityMask];for(t===0?(c=[],r>0&&(this._head=this._head+r+u&this._capacityMask)):(c=this.remove(r,t),this._head=this._head+r+u&this._capacityMask);a>f;)this.unshift(arguments[--a]);for(n=r;n>0;n--)this.unshift(o[n-1]);}else {o=new Array(i-(r+t));var l=o.length;for(n=0;n<l;n++)o[n]=this._list[this._head+r+t+n&this._capacityMask];for(t===0?(c=[],r!=i&&(this._tail=this._head+r+u&this._capacityMask)):(c=this.remove(r,t),this._tail=this._tail-l+u&this._capacityMask);f<a;)this.push(arguments[f++]);for(n=0;n<l;n++)this.push(o[n]);}return c}else return this.remove(r,t)}};C.prototype.clear=function(){this._list=new Array(this._list.length),this._head=0,this._tail=0;};C.prototype.isEmpty=function(){return this._head===this._tail};C.prototype.toArray=function(){return this._copyArray(false)};C.prototype._fromArray=function(e){var t=e.length,r=this._nextPowerOf2(t);this._list=new Array(r),this._capacityMask=r-1,this._tail=t;for(var i=0;i<t;i++)this._list[i]=e[i];};C.prototype._copyArray=function(e,t){var r=this._list,i=r.length,n=this.length;if(t=t|n,t==n&&this._head<this._tail)return this._list.slice(this._head,this._tail);var o=new Array(t),c=0,a;if(e||this._head>this._tail){for(a=this._head;a<i;a++)o[c++]=r[a];for(a=0;a<this._tail;a++)o[c++]=r[a];}else for(a=this._head;a<this._tail;a++)o[c++]=r[a];return o};C.prototype._growArray=function(){if(this._head!=0){var e=this._copyArray(true,this._list.length<<1);this._tail=this._list.length,this._head=0,this._list=e;}else this._tail=this._list.length,this._list.length<<=1;this._capacityMask=this._capacityMask<<1|1;};C.prototype._shrinkArray=function(){this._list.length>>>=1,this._capacityMask>>>=1;};C.prototype._nextPowerOf2=function(e){var t=Math.log(e)/Math.log(2),r=1<<t+1;return Math.max(r,4)};Zr.exports=C;});var $r=p(ss=>{Object.defineProperty(ss,"__esModule",{value:true});var Aa=x(),Ta=Xe(),Oa=(0, Aa.Debug)("delayqueue"),ts=class{constructor(){this.queues={},this.timeouts={};}push(e,t,r){let i=r.callback||process.nextTick;this.queues[e]||(this.queues[e]=new Ta),this.queues[e].push(t),this.timeouts[e]||(this.timeouts[e]=setTimeout(()=>{i(()=>{this.timeouts[e]=null,this.execute(e);});},r.timeout));}execute(e){let t=this.queues[e];if(!t)return;let{length:r}=t;if(r)for(Oa("send %d commands in %s queue",r,e),this.queues[e]=null;t.length>0;)t.shift()();}};ss.default=ts;});var ti=p(is=>{Object.defineProperty(is,"__esModule",{value:true});var ei=ge(),Ma=x(),Ra=G(),Ze=(0, Ma.Debug)("cluster:subscriberGroup:shardedSubscriber"),rs=class{constructor(e,t){this.emitter=e,this.started=false,this.instance=null,this.messageListeners=new Map,this.onEnd=()=>{this.started=false,this.emitter.emit("-node",this.instance,this.nodeKey);},this.onError=r=>{this.emitter.emit("nodeError",r,this.nodeKey);},this.onMoved=()=>{this.emitter.emit("moved");},this.instance=new Ra.default({port:t.port,host:t.host,username:t.username,password:t.password,enableReadyCheck:false,offlineQueue:true,connectionName:(0, ei.getConnectionName)("ssubscriber",t.connectionName),lazyConnect:true,tls:t.tls,retryStrategy:null}),this.nodeKey=(0, ei.getNodeKey)(t),this.instance.once("end",this.onEnd),this.instance.on("error",this.onError),this.instance.on("moved",this.onMoved);for(let r of ["smessage","smessageBuffer"]){let i=(...n)=>{this.emitter.emit(r,...n);};this.messageListeners.set(r,i),this.instance.on(r,i);}}async start(){if(this.started){Ze("already started %s",this.nodeKey);return}try{await this.instance.connect(),Ze("started %s",this.nodeKey),this.started=!0;}catch(e){throw Ze("failed to start %s: %s",this.nodeKey,e),this.started=false,e}}stop(){this.started=false,this.instance&&(this.instance.disconnect(),this.instance.removeAllListeners(),this.messageListeners.clear(),this.instance=null),Ze("stopped %s",this.nodeKey);}isStarted(){return this.started}getInstance(){return this.instance}getNodeKey(){return this.nodeKey}};is.default=rs;});var si=p(ns=>{Object.defineProperty(ns,"__esModule",{value:true});var Ba=x(),Ia=ge(),$e=we(),Pa=ti(),F=(0, Ba.Debug)("cluster:subscriberGroup"),me=class s{constructor(e){this.subscriberGroupEmitter=e,this.shardedSubscribers=new Map,this.clusterSlots=[],this.subscriberToSlotsIndex=new Map,this.channels=new Map,this.failedAttemptsByNode=new Map,this.isResetting=false,this.pendingReset=null,this.handleSubscriberConnectFailed=(t,r)=>{let n=(this.failedAttemptsByNode.get(r)||0)+1;this.failedAttemptsByNode.set(r,n);let o=Math.min(n,s.MAX_RETRY_ATTEMPTS),c=Math.min(s.BASE_BACKOFF_MS*2**o,s.MAX_BACKOFF_MS),a=Math.floor((Math.random()-.5)*(c*.5)),u=Math.max(0,c+a);F("Failed to connect subscriber for %s. Refreshing slots in %dms",r,u),this.subscriberGroupEmitter.emit("subscriberConnectFailed",{delay:u,error:t});},this.handleSubscriberConnectSucceeded=t=>{this.failedAttemptsByNode.delete(t);};}getResponsibleSubscriber(e){let t=this.clusterSlots[e][0];return this.shardedSubscribers.get(t)}addChannels(e){let t=$e(e[0]);for(let i of e)if($e(i)!==t)return  -1;let r=this.channels.get(t);return r?this.channels.set(t,r.concat(e)):this.channels.set(t,e),Array.from(this.channels.values()).reduce((i,n)=>i+n.length,0)}removeChannels(e){let t=$e(e[0]);for(let i of e)if($e(i)!==t)return  -1;let r=this.channels.get(t);if(r){let i=r.filter(n=>!e.includes(n));this.channels.set(t,i);}return Array.from(this.channels.values()).reduce((i,n)=>i+n.length,0)}stop(){for(let e of this.shardedSubscribers.values())e.stop();this.pendingReset=null,this.shardedSubscribers.clear(),this.subscriberToSlotsIndex.clear();}start(){let e=[];for(let t of this.shardedSubscribers.values())t.isStarted()||e.push(t.start().then(()=>{this.handleSubscriberConnectSucceeded(t.getNodeKey());}).catch(r=>{this.handleSubscriberConnectFailed(r,t.getNodeKey());}));return Promise.all(e)}async reset(e,t){if(this.isResetting){this.pendingReset={slots:e,nodes:t};return}this.isResetting=true;try{let r=this._refreshSlots(e),i=this.hasUnhealthySubscribers();if(!r&&!i){F("No topology change detected or failed subscribers. Skipping reset.");return}for(let[o,c]of this.shardedSubscribers){if(this.subscriberToSlotsIndex.has(o)&&c.isStarted()){F("Skipping deleting subscriber for %s",o);continue}F("Removing subscriber for %s",o),c.stop(),this.shardedSubscribers.delete(o),this.subscriberGroupEmitter.emit("-subscriber");}let n=[];for(let[o,c]of this.subscriberToSlotsIndex){if(this.shardedSubscribers.has(o)){F("Skipping creating new subscriber for %s",o);continue}F("Creating new subscriber for %s",o);let a=t.find(f=>(0,Ia.getNodeKey)(f.options)===o);if(!a){F("Failed to find node for key %s",o);continue}let u=new Pa.default(this.subscriberGroupEmitter,a.options);this.shardedSubscribers.set(o,u),n.push(u.start().then(()=>{this.handleSubscriberConnectSucceeded(o);}).catch(f=>{this.handleSubscriberConnectFailed(f,o);})),this.subscriberGroupEmitter.emit("+subscriber");}await Promise.all(n),this._resubscribe(),this.subscriberGroupEmitter.emit("subscribersReady");}finally{if(this.isResetting=false,this.pendingReset){let{slots:r,nodes:i}=this.pendingReset;this.pendingReset=null,await this.reset(r,i);}}}_refreshSlots(e){if(this._slotsAreEqual(e))return F("Nothing to refresh because the new cluster map is equal to the previous one."),false;F("Refreshing the slots of the subscriber group."),this.subscriberToSlotsIndex=new Map;for(let t=0;t<e.length;t++){let r=e[t][0];this.subscriberToSlotsIndex.has(r)||this.subscriberToSlotsIndex.set(r,[]),this.subscriberToSlotsIndex.get(r).push(Number(t));}return this.clusterSlots=JSON.parse(JSON.stringify(e)),true}_resubscribe(){this.shardedSubscribers&&this.shardedSubscribers.forEach((e,t)=>{let r=this.subscriberToSlotsIndex.get(t);r&&r.forEach(i=>{let n=e.getInstance(),o=this.channels.get(i);if(o&&o.length>0){if(n.status==="end")return;n.status==="ready"?n.ssubscribe(...o).catch(c=>{F("Failed to ssubscribe on node %s: %s",t,c);}):n.once("ready",()=>{n.ssubscribe(...o).catch(c=>{F("Failed to ssubscribe on node %s: %s",t,c);});});}});});}_slotsAreEqual(e){return this.clusterSlots===void 0?false:JSON.stringify(this.clusterSlots)===JSON.stringify(e)}hasUnhealthySubscribers(){let e=Array.from(this.shardedSubscribers.values()).some(r=>!r.isStarted()),t=Array.from(this.subscriberToSlotsIndex.keys()).some(r=>!this.shardedSubscribers.has(r));return e||t}};ns.default=me;me.MAX_RETRY_ATTEMPTS=10;me.MAX_BACKOFF_MS=2e3;me.BASE_BACKOFF_MS=100;});var cs=p(as=>{Object.defineProperty(as,"__esModule",{value:true});var ri=ae(),os=k("events"),be=se(),ii=K(),ni=Q(),et=Ir(),Fa=G(),Da=Ke(),Na=Vt(),B=x(),qa=Ht(),ja=Ye(),La=Yr(),Qa=Jr(),za=Xr(),Ga=$r(),Se=ge(),oi=Xe(),Ua=si(),b=(0, B.Debug)("cluster"),ai=new WeakSet,Te=class s extends ja.default{constructor(e,t={}){if(super(),this.slots=[],this._groupsIds={},this._groupsBySlot=Array(16384),this.isCluster=true,this.retryAttempts=0,this.delayQueue=new Ga.default,this.offlineQueue=new oi,this.isRefreshing=false,this._refreshSlotsCacheCallbacks=[],this._autoPipelines=new Map,this._runningAutoPipelines=new Set,this._readyDelayedCallbacks=[],this.connectionEpoch=0,os.EventEmitter.call(this),this.startupNodes=e,this.options=(0, B.defaults)({},t,La.DEFAULT_CLUSTER_OPTIONS,this.options),this.options.shardedSubscribers&&this.createShardedSubscriberGroup(),this.options.redisOptions&&this.options.redisOptions.keyPrefix&&!this.options.keyPrefix&&(this.options.keyPrefix=this.options.redisOptions.keyPrefix),typeof this.options.scaleReads!="function"&&["all","master","slave"].indexOf(this.options.scaleReads)===-1)throw new Error('Invalid option scaleReads "'+this.options.scaleReads+'". Expected "all", "master", "slave" or a custom function');this.connectionPool=new za.default(this.options.redisOptions),this.connectionPool.on("-node",(r,i)=>{this.emit("-node",r);}),this.connectionPool.on("+node",r=>{this.emit("+node",r);}),this.connectionPool.on("drain",()=>{this.setStatus("close");}),this.connectionPool.on("nodeError",(r,i)=>{this.emit("node error",r,i);}),this.subscriber=new Qa.default(this.connectionPool,this),this.options.scripts&&Object.entries(this.options.scripts).forEach(([r,i])=>{this.defineCommand(r,i);}),this.options.lazyConnect?this.setStatus("wait"):this.connect().catch(r=>{b("connecting failed: %s",r);});}connect(){return new Promise((e,t)=>{if(this.status==="connecting"||this.status==="connect"||this.status==="ready"){t(new Error("Redis is already connecting/connected"));return}let r=++this.connectionEpoch;this.setStatus("connecting"),this.resolveStartupNodeHostnames().then(i=>{if(this.connectionEpoch!==r){b("discard connecting after resolving startup nodes because epoch not match: %d != %d",r,this.connectionEpoch),t(new be.RedisError("Connection is discarded because a new connection is made"));return}if(this.status!=="connecting"){b("discard connecting after resolving startup nodes because the status changed to %s",this.status),t(new be.RedisError("Connection is aborted"));return}this.connectionPool.reset(i),this.options.shardedSubscribers&&this.shardedSubscribers.reset(this.slots,this.connectionPool.getNodes("all")).catch(a=>{b("Error while starting subscribers: %s",a);});let n=()=>{this.setStatus("ready"),this.retryAttempts=0,this.executeOfflineCommands(),this.resetNodesRefreshInterval(),e();},o,c=()=>{this.invokeReadyDelayedCallbacks(void 0),this.removeListener("close",o),this.manuallyClosing=false,this.setStatus("connect"),this.options.enableReadyCheck?this.readyCheck((a,u)=>{a||u?(b("Ready check failed (%s). Reconnecting...",a||u),this.status==="connect"&&this.disconnect(true)):n();}):n();};o=()=>{let a=new Error("None of startup nodes is available");this.removeListener("refresh",c),this.invokeReadyDelayedCallbacks(a),t(a);},this.once("refresh",c),this.once("close",o),this.once("close",this.handleCloseEvent.bind(this)),this.refreshSlotsCache(a=>{a&&a.message===et.default.defaultMessage&&(Fa.default.prototype.silentEmit.call(this,"error",a),this.connectionPool.reset([]));}),this.subscriber.start(),this.options.shardedSubscribers&&this.shardedSubscribers.start().catch(a=>{b("Error while starting subscribers: %s",a);});}).catch(i=>{this.setStatus("close"),this.handleCloseEvent(i),this.invokeReadyDelayedCallbacks(i),t(i);});})}disconnect(e=false){let t=this.status;this.setStatus("disconnecting"),e||(this.manuallyClosing=true),this.reconnectTimeout&&!e&&(clearTimeout(this.reconnectTimeout),this.reconnectTimeout=null,b("Canceled reconnecting attempts")),this.clearNodesRefreshInterval(),this.subscriber.stop(),this.options.shardedSubscribers&&this.shardedSubscribers.stop(),t==="wait"?(this.setStatus("close"),this.handleCloseEvent()):this.connectionPool.reset([]);}quit(e){let t=this.status;if(this.setStatus("disconnecting"),this.manuallyClosing=true,this.reconnectTimeout&&(clearTimeout(this.reconnectTimeout),this.reconnectTimeout=null),this.clearNodesRefreshInterval(),this.subscriber.stop(),this.options.shardedSubscribers&&this.shardedSubscribers.stop(),t==="wait"){let r=(0, ii.default)(Promise.resolve("OK"),e);return setImmediate(function(){this.setStatus("close"),this.handleCloseEvent();}.bind(this)),r}return (0, ii.default)(Promise.all(this.nodes().map(r=>r.quit().catch(i=>{if(i.message===B.CONNECTION_CLOSED_ERROR_MSG)return "OK";throw i}))).then(()=>"OK"),e)}duplicate(e=[],t={}){let r=e.length>0?e:this.startupNodes.slice(0),i=Object.assign({},this.options,t);return new s(r,i)}nodes(e="all"){if(e!=="all"&&e!=="master"&&e!=="slave")throw new Error('Invalid role "'+e+'". Expected "all", "master" or "slave"');return this.connectionPool.getNodes(e)}delayUntilReady(e){this._readyDelayedCallbacks.push(e);}get autoPipelineQueueSize(){let e=0;for(let t of this._autoPipelines.values())e+=t.length;return e}refreshSlotsCache(e){if(e&&this._refreshSlotsCacheCallbacks.push(e),this.isRefreshing)return;this.isRefreshing=true;let t=this,r=c=>{this.isRefreshing=false;for(let a of this._refreshSlotsCacheCallbacks)a(c);this._refreshSlotsCacheCallbacks=[];},i=(0, B.shuffle)(this.connectionPool.getNodes()),n=null;function o(c){if(c===i.length){let f=new et.default(et.default.defaultMessage,n);return r(f)}let a=i[c],u=`${a.options.host}:${a.options.port}`;b("getting slot cache from %s",u),t.getInfoFromNode(a,function(f){switch(t.status){case "close":case "end":return r(new Error("Cluster is disconnected."));case "disconnecting":return r(new Error("Cluster is disconnecting."))}f?(t.emit("node error",f,u),n=f,o(c+1)):(t.emit("refresh"),r());});}o(0);}sendCommand(e,t,r){if(this.status==="wait"&&this.connect().catch(B.noop),this.status==="end")return e.reject(new Error(B.CONNECTION_CLOSED_ERROR_MSG)),e.promise;let i=this.options.scaleReads;i!=="master"&&(e.isReadOnly||(0, ri.exists)(e.name)&&(0, ri.hasFlag)(e.name,"readonly")||(i="master"));let n=r?r.slot:e.getSlot(),o={},c=this;if(!r&&!ai.has(e)){ai.add(e);let u=e.reject;e.reject=function(f){let l=a.bind(null,true);c.handleError(f,o,{moved:function(h,d){b("command %s is moved to %s",e.name,d),n=Number(h),c.slots[h]?c.slots[h][0]=d:c.slots[h]=[d],c._groupsBySlot[h]=c._groupsIds[c.slots[h].join(";")],c.connectionPool.findOrCreate(c.natMapper(d)),a(),b("refreshing slot caches... (triggered by MOVED error)"),c.refreshSlotsCache();},ask:function(h,d){b("command %s is required to ask %s:%s",e.name,d);let g=c.natMapper(d);c.connectionPool.findOrCreate(g),a(false,`${g.host}:${g.port}`);},tryagain:l,clusterDown:l,connectionClosed:l,maxRedirections:function(h){u.call(e,h);},defaults:function(){u.call(e,f);}});};}a();function a(u,f){if(c.status==="end"){e.reject(new be.AbortError("Cluster is ended."));return}let l;if(c.status==="ready"||e.name==="cluster"){if(r&&r.redis)l=r.redis;else if(ni.default.checkFlag("ENTER_SUBSCRIBER_MODE",e.name)||ni.default.checkFlag("EXIT_SUBSCRIBER_MODE",e.name)){if(c.options.shardedSubscribers&&(e.name=="ssubscribe"||e.name=="sunsubscribe")){let h=c.shardedSubscribers.getResponsibleSubscriber(n);if(!h){e.reject(new be.AbortError(`No sharded subscriber for slot: ${n}`));return}let d=-1;e.name=="ssubscribe"&&(d=c.shardedSubscribers.addChannels(e.getKeys())),e.name=="sunsubscribe"&&(d=c.shardedSubscribers.removeChannels(e.getKeys())),d!==-1?l=h.getInstance():e.reject(new be.AbortError("Possible CROSSSLOT error: All channels must hash to the same slot"));}else l=c.subscriber.getInstance();if(!l){e.reject(new be.AbortError("No subscriber for the cluster"));return}}else {if(!u){if(typeof n=="number"&&c.slots[n]){let h=c.slots[n];if(typeof i=="function"){let d=h.map(function(g){return c.connectionPool.getInstanceByKey(g)});l=i(d,e),Array.isArray(l)&&(l=(0, B.sample)(l)),l||(l=d[0]);}else {let d;i==="all"?d=(0, B.sample)(h):i==="slave"&&h.length>1?d=(0, B.sample)(h,1):d=h[0],l=c.connectionPool.getInstanceByKey(d);}}f&&(l=c.connectionPool.getInstanceByKey(f),l.asking());}l||(l=(typeof i=="function"?null:c.connectionPool.getSampleInstance(i))||c.connectionPool.getSampleInstance("all"));}r&&!r.redis&&(r.redis=l);}l?l.sendCommand(e,t):c.options.enableOfflineQueue?c.offlineQueue.push({command:e,stream:t,node:r}):e.reject(new Error("Cluster isn't ready and enableOfflineQueue options is false"));}return e.promise}sscanStream(e,t){return this.createScanStream("sscan",{key:e,options:t})}sscanBufferStream(e,t){return this.createScanStream("sscanBuffer",{key:e,options:t})}hscanStream(e,t){return this.createScanStream("hscan",{key:e,options:t})}hscanBufferStream(e,t){return this.createScanStream("hscanBuffer",{key:e,options:t})}zscanStream(e,t){return this.createScanStream("zscan",{key:e,options:t})}zscanBufferStream(e,t){return this.createScanStream("zscanBuffer",{key:e,options:t})}handleError(e,t,r){if(typeof t.value>"u"?t.value=this.options.maxRedirections:t.value-=1,t.value<=0){r.maxRedirections(new Error("Too many Cluster redirections. Last error: "+e));return}let i=e.message.split(" ");if(i[0]==="MOVED"){let n=this.options.retryDelayOnMoved;n&&typeof n=="number"?this.delayQueue.push("moved",r.moved.bind(null,i[1],i[2]),{timeout:n}):r.moved(i[1],i[2]);}else i[0]==="ASK"?r.ask(i[1],i[2]):i[0]==="TRYAGAIN"?this.delayQueue.push("tryagain",r.tryagain,{timeout:this.options.retryDelayOnTryAgain}):i[0]==="CLUSTERDOWN"&&this.options.retryDelayOnClusterDown>0?this.delayQueue.push("clusterdown",r.connectionClosed,{timeout:this.options.retryDelayOnClusterDown,callback:this.refreshSlotsCache.bind(this)}):e.message===B.CONNECTION_CLOSED_ERROR_MSG&&this.options.retryDelayOnFailover>0&&this.status==="ready"?this.delayQueue.push("failover",r.connectionClosed,{timeout:this.options.retryDelayOnFailover,callback:this.refreshSlotsCache.bind(this)}):r.defaults();}resetOfflineQueue(){this.offlineQueue=new oi;}clearNodesRefreshInterval(){this.slotsTimer&&(clearTimeout(this.slotsTimer),this.slotsTimer=null);}resetNodesRefreshInterval(){if(this.slotsTimer||!this.options.slotsRefreshInterval)return;let e=()=>{this.slotsTimer=setTimeout(()=>{b('refreshing slot caches... (triggered by "slotsRefreshInterval" option)'),this.refreshSlotsCache(()=>{e();});},this.options.slotsRefreshInterval);};e();}setStatus(e){b("status: %s -> %s",this.status||"[empty]",e),this.status=e,process.nextTick(()=>{this.emit(e);});}handleCloseEvent(e){var t;e&&b("closed because %s",e);let r;!this.manuallyClosing&&typeof this.options.clusterRetryStrategy=="function"&&(r=this.options.clusterRetryStrategy.call(this,++this.retryAttempts,e)),typeof r=="number"?(this.setStatus("reconnecting"),this.reconnectTimeout=setTimeout(()=>{this.reconnectTimeout=null,b("Cluster is disconnected. Retrying after %dms",r),this.connect().catch(function(i){b("Got error %s when reconnecting. Ignoring...",i);});},r)):(this.options.shardedSubscribers&&((t=this.subscriberGroupEmitter)===null||t===void 0||t.removeAllListeners()),this.setStatus("end"),this.flushQueue(new Error("None of startup nodes is available")));}flushQueue(e){let t;for(;t=this.offlineQueue.shift();)t.command.reject(e);}executeOfflineCommands(){if(this.offlineQueue.length){b("send %d commands in offline queue",this.offlineQueue.length);let e=this.offlineQueue;this.resetOfflineQueue();let t;for(;t=e.shift();)this.sendCommand(t.command,t.stream,t.node);}}natMapper(e){let t=typeof e=="string"?e:`${e.host}:${e.port}`,r=null;return this.options.natMap&&typeof this.options.natMap=="function"?r=this.options.natMap(t):this.options.natMap&&typeof this.options.natMap=="object"&&(r=this.options.natMap[t]),r?(b("NAT mapping %s -> %O",t,r),Object.assign({},r)):typeof e=="string"?(0, Se.nodeKeyToRedisOptions)(e):e}getInfoFromNode(e,t){if(!e)return t(new Error("Node is disconnected"));let r=e.duplicate({enableOfflineQueue:true,enableReadyCheck:false,retryStrategy:null,connectionName:(0, Se.getConnectionName)("refresher",this.options.redisOptions&&this.options.redisOptions.connectionName)});r.on("error",B.noop),r.cluster("SLOTS",(0, B.timeout)((i,n)=>{if(r.disconnect(),i)return b("error encountered running CLUSTER.SLOTS: %s",i),t(i);if(this.status==="disconnecting"||this.status==="close"||this.status==="end"){b("ignore CLUSTER.SLOTS results (count: %d) since cluster status is %s",n.length,this.status),t();return}let o=[];b("cluster slots result count: %d",n.length);for(let a=0;a<n.length;++a){let u=n[a],f=u[0],l=u[1],h=[];for(let d=2;d<u.length;d++){if(!u[d][0])continue;let g=this.natMapper({host:u[d][0],port:u[d][1]});g.readOnly=d!==2,o.push(g),h.push(g.host+":"+g.port);}b("cluster slots result [%d]: slots %d~%d served by %s",a,f,l,h);for(let d=f;d<=l;d++)this.slots[d]=h;}this._groupsIds=Object.create(null);let c=0;for(let a=0;a<16384;a++){let u=(this.slots[a]||[]).join(";");if(!u.length){this._groupsBySlot[a]=void 0;continue}this._groupsIds[u]||(this._groupsIds[u]=++c),this._groupsBySlot[a]=this._groupsIds[u];}this.connectionPool.reset(o),this.options.shardedSubscribers&&this.shardedSubscribers.reset(this.slots,this.connectionPool.getNodes("all")).catch(a=>{b("Error while starting subscribers: %s",a);}),t();},this.options.slotsRefreshTimeout));}invokeReadyDelayedCallbacks(e){for(let t of this._readyDelayedCallbacks)process.nextTick(t,e);this._readyDelayedCallbacks=[];}readyCheck(e){this.cluster("INFO",(t,r)=>{if(t)return e(t);if(typeof r!="string")return e();let i,n=r.split(`\r
`);for(let o=0;o<n.length;++o){let c=n[o].split(":");if(c[0]==="cluster_state"){i=c[1];break}}i==="fail"?(b("cluster state not ok (%s)",i),e(null,i)):e();});}resolveSrv(e){return new Promise((t,r)=>{this.options.resolveSrv(e,(i,n)=>{if(i)return r(i);let o=this,c=(0, Se.groupSrvRecords)(n),a=Object.keys(c).sort((f,l)=>parseInt(f)-parseInt(l));function u(f){if(!a.length)return r(f);let l=a[0],h=c[l],d=(0, Se.weightSrvRecords)(h);h.records.length||a.shift(),o.dnsLookup(d.name).then(g=>t({host:g,port:d.port}),u);}u();});})}dnsLookup(e){return new Promise((t,r)=>{this.options.dnsLookup(e,(i,n)=>{i?(b("failed to resolve hostname %s to IP: %s",e,i.message),r(i)):(b("resolved hostname %s to IP %s",e,n),t(n));});})}async resolveStartupNodeHostnames(){if(!Array.isArray(this.startupNodes)||this.startupNodes.length===0)throw new Error("`startupNodes` should contain at least one node.");let e=(0, Se.normalizeNodeOptions)(this.startupNodes),t=(0, Se.getUniqueHostnamesFromOptions)(e);if(t.length===0)return e;let r=await Promise.all(t.map((this.options.useSRVRecords?this.resolveSrv:this.dnsLookup).bind(this))),i=(0, B.zipMap)(t,r);return e.map(n=>{let o=i.get(n.host);return o?this.options.useSRVRecords?Object.assign({},n,o):Object.assign({},n,{host:o}):n})}createScanStream(e,{key:t,options:r={}}){return new Da.default({objectMode:true,key:t,redis:this,command:e,...r})}createShardedSubscriberGroup(){this.subscriberGroupEmitter=new os.EventEmitter,this.shardedSubscribers=new Ua.default(this.subscriberGroupEmitter);let e=t=>{t instanceof et.default&&this.disconnect(true);};this.subscriberGroupEmitter.on("-node",(t,r)=>{this.emit("-node",t,r),this.refreshSlotsCache(e);}),this.subscriberGroupEmitter.on("subscriberConnectFailed",({delay:t,error:r})=>{this.emit("error",r),setTimeout(()=>{this.refreshSlotsCache(e);},t);}),this.subscriberGroupEmitter.on("moved",()=>{this.refreshSlotsCache(e);}),this.subscriberGroupEmitter.on("-subscriber",()=>{this.emit("-subscriber");}),this.subscriberGroupEmitter.on("+subscriber",()=>{this.emit("+subscriber");}),this.subscriberGroupEmitter.on("nodeError",(t,r)=>{this.emit("nodeError",t,r);}),this.subscriberGroupEmitter.on("subscribersReady",()=>{this.emit("subscribersReady");});for(let t of ["smessage","smessageBuffer"])this.subscriberGroupEmitter.on(t,(r,i,n)=>{this.emit(t,r,i,n);});}};(0, qa.default)(Te,os.EventEmitter);(0, Na.addTransactionSupport)(Te.prototype);as.default=Te;});var tt=p(us=>{Object.defineProperty(us,"__esModule",{value:true});var Ka=x(),Va=(0, Ka.Debug)("AbstractConnector"),ls=class{constructor(e){this.connecting=false,this.disconnectTimeout=e;}check(e){return  true}disconnect(){if(this.connecting=false,this.stream){let e=this.stream,t=setTimeout(()=>{Va("stream %s:%s still open, destroying it",e.remoteAddress,e.remotePort),e.destroy();},this.disconnectTimeout);e.on("close",()=>clearTimeout(t)),e.end();}}};us.default=ls;});var ci=p(hs=>{Object.defineProperty(hs,"__esModule",{value:true});var Ya=k("net"),Ha=k("tls"),Wa=x(),Ja=tt(),fs=class extends Ja.default{constructor(e){super(e.disconnectTimeout),this.options=e;}connect(e){let{options:t}=this;this.connecting=true;let r;return "path"in t&&t.path?r={path:t.path}:(r={},"port"in t&&t.port!=null&&(r.port=t.port),"host"in t&&t.host!=null&&(r.host=t.host),"family"in t&&t.family!=null&&(r.family=t.family)),t.tls&&Object.assign(r,t.tls),new Promise((i,n)=>{process.nextTick(()=>{if(!this.connecting){n(new Error(Wa.CONNECTION_CLOSED_ERROR_MSG));return}try{t.tls?this.stream=(0,Ha.connect)(r):this.stream=(0,Ya.createConnection)(r);}catch(o){n(o);return}this.stream.once("error",o=>{this.firstError=o;}),i(this.stream);});})}};hs.default=fs;});var li=p(ps=>{Object.defineProperty(ps,"__esModule",{value:true});function Xa(s,e){return (s.host||"127.0.0.1")===(e.host||"127.0.0.1")&&(s.port||26379)===(e.port||26379)}var ds=class{constructor(e){this.cursor=0,this.sentinels=e.slice(0);}next(){let e=this.cursor>=this.sentinels.length;return {done:e,value:e?void 0:this.sentinels[this.cursor++]}}reset(e){e&&this.sentinels.length>1&&this.cursor!==1&&this.sentinels.unshift(...this.sentinels.splice(this.cursor-1)),this.cursor=0;}add(e){for(let t=0;t<this.sentinels.length;t++)if(Xa(e,this.sentinels[t]))return  false;return this.sentinels.push(e),true}toString(){return `${JSON.stringify(this.sentinels)} @${this.cursor}`}};ps.default=ds;});var fi=p(st=>{Object.defineProperty(st,"__esModule",{value:true});st.FailoverDetector=void 0;var Za=x(),ys=(0, Za.Debug)("FailoverDetector"),ui="+switch-master",gs=class{constructor(e,t){this.isDisconnected=false,this.connector=e,this.sentinels=t;}cleanup(){this.isDisconnected=true;for(let e of this.sentinels)e.client.disconnect();}async subscribe(){ys("Starting FailoverDetector");let e=[];for(let t of this.sentinels){let r=t.client.subscribe(ui).catch(i=>{ys("Failed to subscribe to failover messages on sentinel %s:%s (%s)",t.address.host||"127.0.0.1",t.address.port||26739,i.message);});e.push(r),t.client.on("message",i=>{!this.isDisconnected&&i===ui&&this.disconnect();});}await Promise.all(e);}disconnect(){this.isDisconnected=true,ys("Failover detected, disconnecting"),this.connector.disconnect();}};st.FailoverDetector=gs;});var rt=p(Me=>{Object.defineProperty(Me,"__esModule",{value:true});Me.SentinelIterator=void 0;var $a=k("net"),Oe=x(),ec=k("tls"),hi=li();Me.SentinelIterator=hi.default;var tc=tt(),sc=G(),rc=fi(),ke=(0, Oe.Debug)("SentinelConnector"),ms=class extends tc.default{constructor(e){if(super(e.disconnectTimeout),this.options=e,this.emitter=null,this.failoverDetector=null,!this.options.sentinels.length)throw new Error("Requires at least one sentinel to connect to.");if(!this.options.name)throw new Error("Requires the name of master.");this.sentinelIterator=new hi.default(this.options.sentinels);}check(e){let t=!e.role||this.options.role===e.role;return t||(ke("role invalid, expected %s, but got %s",this.options.role,e.role),this.sentinelIterator.next(),this.sentinelIterator.next(),this.sentinelIterator.reset(true)),t}disconnect(){super.disconnect(),this.failoverDetector&&this.failoverDetector.cleanup();}connect(e){this.connecting=true,this.retryAttempts=0;let t,r=async()=>{let i=this.sentinelIterator.next();if(i.done){this.sentinelIterator.reset(false);let a=typeof this.options.sentinelRetryStrategy=="function"?this.options.sentinelRetryStrategy(++this.retryAttempts):null,u=typeof a!="number"?"All sentinels are unreachable and retry is disabled.":`All sentinels are unreachable. Retrying from scratch after ${a}ms.`;t&&(u+=` Last error: ${t.message}`),ke(u);let f=new Error(u);if(typeof a=="number")return e("error",f),await new Promise(l=>setTimeout(l,a)),r();throw f}let n=null,o=null;try{n=await this.resolve(i.value);}catch(a){o=a;}if(!this.connecting)throw new Error(Oe.CONNECTION_CLOSED_ERROR_MSG);let c=i.value.host+":"+i.value.port;if(n)return ke("resolved: %s:%s from sentinel %s",n.host,n.port,c),this.options.enableTLSForSentinelMode&&this.options.tls?(Object.assign(n,this.options.tls),this.stream=(0, ec.connect)(n),this.stream.once("secureConnect",this.initFailoverDetector.bind(this))):(this.stream=(0, $a.createConnection)(n),this.stream.once("connect",this.initFailoverDetector.bind(this))),this.stream.once("error",a=>{this.firstError=a;}),this.stream;{let a=o?"failed to connect to sentinel "+c+" because "+o.message:"connected to sentinel "+c+" successfully, but got an invalid reply: "+n;return ke(a),e("sentinelError",new Error(a)),o&&(t=o),r()}};return r()}async updateSentinels(e){if(!this.options.updateSentinels)return;let t=await e.sentinel("sentinels",this.options.name);Array.isArray(t)&&(t.map(Oe.packObject).forEach(r=>{if((r.flags?r.flags.split(","):[]).indexOf("disconnected")===-1&&r.ip&&r.port){let n=this.sentinelNatResolve(di(r));this.sentinelIterator.add(n)&&ke("adding sentinel %s:%s",n.host,n.port);}}),ke("Updated internal sentinels: %s",this.sentinelIterator));}async resolveMaster(e){let t=await e.sentinel("get-master-addr-by-name",this.options.name);return await this.updateSentinels(e),this.sentinelNatResolve(Array.isArray(t)?{host:t[0],port:Number(t[1])}:null)}async resolveSlave(e){let t=await e.sentinel("slaves",this.options.name);if(!Array.isArray(t))return null;let r=t.map(Oe.packObject).filter(i=>i.flags&&!i.flags.match(/(disconnected|s_down|o_down)/));return this.sentinelNatResolve(ic(r,this.options.preferredSlaves))}sentinelNatResolve(e){if(!e||!this.options.natMap)return e;let t=`${e.host}:${e.port}`,r=e;return typeof this.options.natMap=="function"?r=this.options.natMap(t)||e:typeof this.options.natMap=="object"&&(r=this.options.natMap[t]||e),r}connectToSentinel(e,t){return new sc.default({port:e.port||26379,host:e.host,username:this.options.sentinelUsername||null,password:this.options.sentinelPassword||null,family:e.family||("path"in this.options&&this.options.path?void 0:this.options.family),tls:this.options.sentinelTLS,retryStrategy:null,enableReadyCheck:false,connectTimeout:this.options.connectTimeout,commandTimeout:this.options.sentinelCommandTimeout,...t})}async resolve(e){let t=this.connectToSentinel(e);t.on("error",nc);try{return this.options.role==="slave"?await this.resolveSlave(t):await this.resolveMaster(t)}finally{t.disconnect();}}async initFailoverDetector(){var e;if(!this.options.failoverDetector)return;this.sentinelIterator.reset(true);let t=[];for(;t.length<this.options.sentinelMaxConnections;){let{done:r,value:i}=this.sentinelIterator.next();if(r)break;let n=this.connectToSentinel(i,{lazyConnect:true,retryStrategy:this.options.sentinelReconnectStrategy});n.on("reconnecting",()=>{var o;(o=this.emitter)===null||o===void 0||o.emit("sentinelReconnecting");}),t.push({address:i,client:n});}this.sentinelIterator.reset(false),this.failoverDetector&&this.failoverDetector.cleanup(),this.failoverDetector=new rc.FailoverDetector(this,t),await this.failoverDetector.subscribe(),(e=this.emitter)===null||e===void 0||e.emit("failoverSubscribed");}};Me.default=ms;function ic(s,e){if(s.length===0)return null;let t;if(typeof e=="function")t=e(s);else if(e!==null&&typeof e=="object"){let r=Array.isArray(e)?e:[e];r.sort((i,n)=>(i.prio||(i.prio=1),n.prio||(n.prio=1),i.prio<n.prio?-1:i.prio>n.prio?1:0));for(let i=0;i<r.length;i++){for(let n=0;n<s.length;n++){let o=s[n];if(o.ip===r[i].ip&&o.port===r[i].port){t=o;break}}if(t)break}}return t||(t=(0, Oe.sample)(s)),di(t)}function di(s){return {host:s.ip,port:Number(s.port)}}function nc(){}});var pi=p(Ce=>{Object.defineProperty(Ce,"__esModule",{value:true});Ce.SentinelConnector=Ce.StandaloneConnector=void 0;var oc=ci();Ce.StandaloneConnector=oc.default;var ac=rt();Ce.SentinelConnector=ac.default;});var yi=p(Ss=>{Object.defineProperty(Ss,"__esModule",{value:true});var cc=se(),bs=class extends cc.AbortError{constructor(e){let t=`Reached the max retries per request limit (which is ${e}). Refer to "maxRetriesPerRequest" option for details.`;super(t),Error.captureStackTrace(this,this.constructor);}get name(){return this.constructor.name}};Ss.default=bs;});var gi=p(it=>{Object.defineProperty(it,"__esModule",{value:true});it.MaxRetriesPerRequestError=void 0;var lc=yi();it.MaxRetriesPerRequestError=lc.default;});var vi=p((du,_i)=>{var Es=k("buffer").Buffer,uc=k("string_decoder").StringDecoder,ks=new uc,mi=se(),fc=mi.ReplyError,hc=mi.ParserError,D=Es.allocUnsafe(32*1024),O=0,nt=null,Re=0,Cs=0;function dc(s){let e=s.buffer.length-1;var t=s.offset,r=0,i=1;for(s.buffer[t]===45&&(i=-1,t++);t<e;){let n=s.buffer[t++];if(n===13)return s.offset=t+1,i*r;r=r*10+(n-48);}}function pc(s){let e=s.buffer.length-1;var t=s.offset,r=0,i="";for(s.buffer[t]===45&&(i+="-",t++);t<e;){var n=s.buffer[t++];if(n===13)return s.offset=t+1,r!==0&&(i+=r),i;r>429496728?(i+=r*10+(n-48),r=0):n===48&&r===0?i+=0:r=r*10+(n-48);}}function bi(s){let e=s.offset,t=s.buffer,r=t.length-1;for(var i=e;i<r;)if(t[i++]===13)return s.offset=i+1,s.optionReturnBuffers===true?s.buffer.slice(e,i-1):s.buffer.toString("utf8",e,i-1)}function Si(s){let e=s.buffer.length-1;for(var t=s.offset,r=0;t<e;){let i=s.buffer[t++];if(i===13)return s.offset=t+1,r;r=r*10+(i-48);}}function yc(s){return s.optionStringNumbers===true?pc(s):dc(s)}function gc(s){let e=Si(s);if(e===void 0)return;if(e<0)return null;let t=s.offset+e;if(t+2>s.buffer.length){s.bigStrSize=t+2,s.totalChunkSize=s.buffer.length,s.bufferCache.push(s.buffer);return}let r=s.offset;return s.offset=t+2,s.optionReturnBuffers===true?s.buffer.slice(r,t):s.buffer.toString("utf8",r,t)}function mc(s){var e=bi(s);if(e!==void 0)return s.optionReturnBuffers===true&&(e=e.toString()),new fc(e)}function bc(s,e){let t=new hc("Protocol error, got "+JSON.stringify(String.fromCharCode(e))+" as reply type byte",JSON.stringify(s.buffer),s.offset);s.buffer=null,s.returnFatalError(t);}function Sc(s){let e=Si(s);if(e===void 0)return;if(e<0)return null;let t=new Array(e);return ki(s,t,0)}function _s(s,e,t){s.arrayCache.push(e),s.arrayPos.push(t);}function vs(s){let e=s.arrayCache.pop();var t=s.arrayPos.pop();if(s.arrayCache.length){let r=vs(s);if(r===void 0){_s(s,e,t);return}e[t++]=r;}return ki(s,e,t)}function ki(s,e,t){let r=s.buffer.length;for(;t<e.length;){let i=s.offset;if(s.offset>=r){_s(s,e,t);return}let n=Ci(s,s.buffer[s.offset++]);if(n===void 0){s.arrayCache.length||s.bufferCache.length||(s.offset=i),_s(s,e,t);return}e[t]=n,t++;}return e}function Ci(s,e){switch(e){case 36:return gc(s);case 43:return bi(s);case 42:return Sc(s);case 58:return yc(s);case 45:return mc(s);default:return bc(s,e)}}function kc(){if(D.length>50*1024)if(Re===1||Cs>Re*2){let s=Math.floor(D.length/10),e=s<O?O:s;O=0,D=D.slice(e,D.length);}else Cs++,Re--;else clearInterval(nt),Re=0,Cs=0,nt=null;}function Cc(s){if(D.length<s+O){let e=s>78643200?2:3;O>1024*1024*111&&(O=1024*1024*50),D=Es.allocUnsafe(s*e+O),O=0,Re++,nt===null&&(nt=setInterval(kc,50));}}function _c(s){let e=s.bufferCache,t=s.offset;var r=e.length,i=s.bigStrSize-s.totalChunkSize;if(s.offset=i,i<=2){if(r===2)return e[0].toString("utf8",t,e[0].length+i-2);r--,i=e[e.length-2].length+i;}for(var n=ks.write(e[0].slice(t)),o=1;o<r-1;o++)n+=ks.write(e[o]);return n+=ks.end(e[o].slice(0,i-2)),n}function vc(s){let e=s.bufferCache,t=s.offset,r=s.bigStrSize-t-2;var i=e.length,n=s.bigStrSize-s.totalChunkSize;if(s.offset=n,n<=2){if(i===2)return e[0].slice(t,e[0].length+n-2);i--,n=e[e.length-2].length+n;}Cc(r);let o=O;e[0].copy(D,o,t,e[0].length),O+=e[0].length-t;for(var c=1;c<i-1;c++)e[c].copy(D,O),O+=e[c].length;return e[c].copy(D,O,0,n-2),O+=n-2,D.slice(o,O)}var ws=class{constructor(e){if(!e)throw new TypeError("Options are mandatory.");if(typeof e.returnError!="function"||typeof e.returnReply!="function")throw new TypeError("The returnReply and returnError options have to be functions.");this.setReturnBuffers(!!e.returnBuffers),this.setStringNumbers(!!e.stringNumbers),this.returnError=e.returnError,this.returnFatalError=e.returnFatalError||e.returnError,this.returnReply=e.returnReply,this.reset();}reset(){this.offset=0,this.buffer=null,this.bigStrSize=0,this.totalChunkSize=0,this.bufferCache=[],this.arrayCache=[],this.arrayPos=[];}setReturnBuffers(e){if(typeof e!="boolean")throw new TypeError("The returnBuffers argument has to be a boolean");this.optionReturnBuffers=e;}setStringNumbers(e){if(typeof e!="boolean")throw new TypeError("The stringNumbers argument has to be a boolean");this.optionStringNumbers=e;}execute(e){if(this.buffer===null)this.buffer=e,this.offset=0;else if(this.bigStrSize===0){let r=this.buffer.length,i=r-this.offset,n=Es.allocUnsafe(i+e.length);if(this.buffer.copy(n,0,this.offset,r),e.copy(n,i,0,e.length),this.buffer=n,this.offset=0,this.arrayCache.length){let o=vs(this);if(o===void 0)return;this.returnReply(o);}}else if(this.totalChunkSize+e.length>=this.bigStrSize){this.bufferCache.push(e);var t=this.optionReturnBuffers?vc(this):_c(this);if(this.bigStrSize=0,this.bufferCache=[],this.buffer=e,this.arrayCache.length&&(this.arrayCache[0][this.arrayPos[0]++]=t,t=vs(this),t===void 0))return;this.returnReply(t);}else {this.bufferCache.push(e),this.totalChunkSize+=e.length;return}for(;this.offset<this.buffer.length;){let r=this.offset,i=this.buffer[this.offset++],n=Ci(this,i);if(n===void 0){this.arrayCache.length||this.bufferCache.length||(this.offset=r);return}i===45?this.returnError(n):this.returnReply(n);}this.buffer=null;}};_i.exports=ws;});var Ei=p((pu,wi)=>{wi.exports=vi();});var xi=p(Ts=>{Object.defineProperty(Ts,"__esModule",{value:true});var As=class{constructor(){this.set={subscribe:{},psubscribe:{},ssubscribe:{}};}add(e,t){this.set[xs(e)][t]=true;}del(e,t){delete this.set[xs(e)][t];}channels(e){return Object.keys(this.set[xs(e)])}isEmpty(){return this.channels("subscribe").length===0&&this.channels("psubscribe").length===0&&this.channels("ssubscribe").length===0}};Ts.default=As;function xs(s){return s==="unsubscribe"?"subscribe":s==="punsubscribe"?"psubscribe":s==="sunsubscribe"?"ssubscribe":s}});var Mi=p(Ms=>{Object.defineProperty(Ms,"__esModule",{value:true});var Ai=Q(),wc=x(),Ec=Ei(),xc=xi(),Ac=(0, wc.Debug)("dataHandler"),Os=class{constructor(e,t){this.redis=e;let r=new Ec({stringNumbers:t.stringNumbers,returnBuffers:true,returnError:i=>{this.returnError(i);},returnFatalError:i=>{this.returnFatalError(i);},returnReply:i=>{this.returnReply(i);}});e.stream.prependListener("data",i=>{r.execute(i);}),e.stream.resume();}returnFatalError(e){e.message+=". Please report this.",this.redis.recoverFromFatalError(e,e,{offlineQueue:false});}returnError(e){let t=this.shiftCommand(e);if(t){if(e.command={name:t.command.name,args:t.command.args},t.command.name=="ssubscribe"&&e.message.includes("MOVED")){this.redis.emit("moved");return}this.redis.handleReconnection(e,t);}}returnReply(e){if(this.handleMonitorReply(e)||this.handleSubscriberReply(e))return;let t=this.shiftCommand(e);t&&(Ai.default.checkFlag("ENTER_SUBSCRIBER_MODE",t.command.name)?(this.redis.condition.subscriber=new xc.default,this.redis.condition.subscriber.add(t.command.name,e[1].toString()),Ti(t.command,e[2])||this.redis.commandQueue.unshift(t)):Ai.default.checkFlag("EXIT_SUBSCRIBER_MODE",t.command.name)?Oi(t.command,e[2])||this.redis.commandQueue.unshift(t):t.command.resolve(e));}handleSubscriberReply(e){if(!this.redis.condition.subscriber)return  false;let t=Array.isArray(e)?e[0].toString():null;switch(Ac('receive reply "%s" in subscriber mode',t),t){case "message":this.redis.listeners("message").length>0&&this.redis.emit("message",e[1].toString(),e[2]?e[2].toString():""),this.redis.emit("messageBuffer",e[1],e[2]);break;case "pmessage":{let r=e[1].toString();this.redis.listeners("pmessage").length>0&&this.redis.emit("pmessage",r,e[2].toString(),e[3].toString()),this.redis.emit("pmessageBuffer",r,e[2],e[3]);break}case "smessage":{this.redis.listeners("smessage").length>0&&this.redis.emit("smessage",e[1].toString(),e[2]?e[2].toString():""),this.redis.emit("smessageBuffer",e[1],e[2]);break}case "ssubscribe":case "subscribe":case "psubscribe":{let r=e[1].toString();this.redis.condition.subscriber.add(t,r);let i=this.shiftCommand(e);if(!i)return;Ti(i.command,e[2])||this.redis.commandQueue.unshift(i);break}case "sunsubscribe":case "unsubscribe":case "punsubscribe":{let r=e[1]?e[1].toString():null;r&&this.redis.condition.subscriber.del(t,r);let i=e[2];Number(i)===0&&(this.redis.condition.subscriber=false);let n=this.shiftCommand(e);if(!n)return;Oi(n.command,i)||this.redis.commandQueue.unshift(n);break}default:{let r=this.shiftCommand(e);if(!r)return;r.command.resolve(e);}}return  true}handleMonitorReply(e){if(this.redis.status!=="monitoring")return  false;let t=e.toString();if(t==="OK")return  false;let r=t.indexOf(" "),i=t.slice(0,r),n=t.indexOf('"'),o=t.slice(n+1,-1).split('" "').map(a=>a.replace(/\\"/g,'"')),c=t.slice(r+2,n-2).split(" ");return this.redis.emit("monitor",i,o,c[1],c[0]),true}shiftCommand(e){let t=this.redis.commandQueue.shift();if(!t){let r="Command queue state error. If you can reproduce this, please report it.",i=new Error(r+(e instanceof Error?` Last error: ${e.message}`:` Last reply: ${e.toString()}`));return this.redis.emit("error",i),null}return t}};Ms.default=Os;var J=new WeakMap;function Ti(s,e){let t=J.has(s)?J.get(s):s.args.length;return t-=1,t<=0?(s.resolve(e),J.delete(s),true):(J.set(s,t),false)}function Oi(s,e){let t=J.has(s)?J.get(s):s.args.length;return t===0?Number(e)===0?(J.delete(s),s.resolve(e),true):false:(t-=1,t<=0?(s.resolve(e),true):(J.set(s,t),false))}});var Ri=p(P=>{Object.defineProperty(P,"__esModule",{value:true});P.readyHandler=P.errorHandler=P.closeHandler=P.connectHandler=void 0;var Tc=se(),Oc=Q(),Mc=gi(),j=x(),Rc=Mi(),A=(0, j.Debug)("connection");function Bc(s){return function(){var e;s.setStatus("connect"),s.resetCommandQueue();let t=false,{connectionEpoch:r}=s;s.condition.auth&&s.auth(s.condition.auth,function(n){r===s.connectionEpoch&&n&&(n.message.indexOf("no password is set")!==-1?console.warn("[WARN] Redis server does not require a password, but a password was supplied."):n.message.indexOf("without any password configured for the default user")!==-1?console.warn("[WARN] This Redis server's `default` user does not require a password, but a password was supplied"):n.message.indexOf("wrong number of arguments for 'auth' command")!==-1?console.warn(`[ERROR] The server returned "wrong number of arguments for 'auth' command". You are probably passing both username and password to Redis version 5 or below. You should only pass the 'password' option for Redis version 5 and under.`):(t=true,s.recoverFromFatalError(n,n)));}),s.condition.select&&s.select(s.condition.select).catch(n=>{s.silentEmit("error",n);}),new Rc.default(s,{stringNumbers:s.options.stringNumbers});let i=[];s.options.connectionName&&(A("set the connection name [%s]",s.options.connectionName),i.push(s.client("setname",s.options.connectionName).catch(j.noop))),s.options.disableClientInfo||(A("set the client info"),i.push((0, j.getPackageMeta)().then(n=>s.client("SETINFO","LIB-VER",n.version).catch(j.noop)).catch(j.noop)),i.push(s.client("SETINFO","LIB-NAME",!((e=s.options)===null||e===void 0)&&e.clientInfoTag?`ioredis(${s.options.clientInfoTag})`:"ioredis").catch(j.noop))),Promise.all(i).catch(j.noop).finally(()=>{s.options.enableReadyCheck||P.readyHandler(s)(),s.options.enableReadyCheck&&s._readyCheck(function(n,o){r===s.connectionEpoch&&(n?t||s.recoverFromFatalError(new Error("Ready check failed: "+n.message),n):s.connector.check(o)?P.readyHandler(s)():s.disconnect(true));});});}}P.connectHandler=Bc;function Rs(s){let e=new Tc.AbortError("Command aborted due to connection close");return e.command={name:s.name,args:s.args},e}function Ic(s){var e;let t=0;for(let r=0;r<s.length;){let i=(e=s.peekAt(r))===null||e===void 0?void 0:e.command,n=i.pipelineIndex;if((n===void 0||n===0)&&(t=0),n!==void 0&&n!==t++){s.remove(r,1),i.reject(Rs(i));continue}r++;}}function Pc(s){var e;for(let t=0;t<s.length;){let r=(e=s.peekAt(t))===null||e===void 0?void 0:e.command;if(r.name==="multi")break;if(r.name==="exec"){s.remove(t,1),r.reject(Rs(r));break}r.inTransaction?(s.remove(t,1),r.reject(Rs(r))):t++;}}function Fc(s){return function(){let t=s.status;if(s.setStatus("close"),s.commandQueue.length&&Ic(s.commandQueue),s.offlineQueue.length&&Pc(s.offlineQueue),t==="ready"&&(s.prevCondition||(s.prevCondition=s.condition),s.commandQueue.length&&(s.prevCommandQueue=s.commandQueue)),s.manuallyClosing)return s.manuallyClosing=false,A("skip reconnecting since the connection is manually closed."),e();if(typeof s.options.retryStrategy!="function")return A("skip reconnecting because `retryStrategy` is not a function"),e();let r=s.options.retryStrategy(++s.retryAttempts);if(typeof r!="number")return A("skip reconnecting because `retryStrategy` doesn't return a number"),e();A("reconnect in %sms",r),s.setStatus("reconnecting",r),s.reconnectTimeout=setTimeout(function(){s.reconnectTimeout=null,s.connect().catch(j.noop);},r);let{maxRetriesPerRequest:i}=s.options;typeof i=="number"&&(i<0?A("maxRetriesPerRequest is negative, ignoring..."):s.retryAttempts%(i+1)===0&&(A("reach maxRetriesPerRequest limitation, flushing command queue..."),s.flushQueue(new Mc.MaxRetriesPerRequestError(i))));};function e(){s.setStatus("end"),s.flushQueue(new Error(j.CONNECTION_CLOSED_ERROR_MSG));}}P.closeHandler=Fc;function Dc(s){return function(e){A("error: %s",e),s.silentEmit("error",e);}}P.errorHandler=Dc;function Nc(s){return function(){if(s.setStatus("ready"),s.retryAttempts=0,s.options.monitor){s.call("monitor").then(()=>s.setStatus("monitoring"),r=>s.emit("error",r));let{sendCommand:t}=s;s.sendCommand=function(r){return Oc.default.checkFlag("VALID_IN_MONITOR_MODE",r.name)?t.call(s,r):(r.reject(new Error("Connection is in monitoring mode, can't process commands.")),r.promise)},s.once("close",function(){delete s.sendCommand;});return}let e=s.prevCondition?s.prevCondition.select:s.condition.select;if(s.options.readOnly&&(A("set the connection to readonly mode"),s.readonly().catch(j.noop)),s.prevCondition){let t=s.prevCondition;if(s.prevCondition=null,t.subscriber&&s.options.autoResubscribe){s.condition.select!==e&&(A("connect to db [%d]",e),s.select(e));let r=t.subscriber.channels("subscribe");r.length&&(A("subscribe %d channels",r.length),s.subscribe(r));let i=t.subscriber.channels("psubscribe");i.length&&(A("psubscribe %d channels",i.length),s.psubscribe(i));let n=t.subscriber.channels("ssubscribe");if(n.length){A("ssubscribe %s",n.length);for(let o of n)s.ssubscribe(o);}}}if(s.prevCommandQueue)if(s.options.autoResendUnfulfilledCommands)for(A("resend %d unfulfilled commands",s.prevCommandQueue.length);s.prevCommandQueue.length>0;){let t=s.prevCommandQueue.shift();t.select!==s.condition.select&&t.command.name!=="select"&&s.select(t.select),s.sendCommand(t.command,t.stream);}else s.prevCommandQueue=null;if(s.offlineQueue.length){A("send %d commands in offline queue",s.offlineQueue.length);let t=s.offlineQueue;for(s.resetOfflineQueue();t.length>0;){let r=t.shift();r.select!==s.condition.select&&r.command.name!=="select"&&s.select(r.select),s.sendCommand(r.command,r.stream);}}s.condition.select!==e&&(A("connect to db [%d]",e),s.select(e));}}P.readyHandler=Nc;});var Bi=p(ot=>{Object.defineProperty(ot,"__esModule",{value:true});ot.DEFAULT_REDIS_OPTIONS=void 0;ot.DEFAULT_REDIS_OPTIONS={port:6379,host:"localhost",family:0,connectTimeout:1e4,disconnectTimeout:2e3,retryStrategy:function(s){return Math.min(s*50,2e3)},keepAlive:0,noDelay:true,connectionName:null,disableClientInfo:false,clientInfoTag:void 0,sentinels:null,name:null,role:"master",sentinelRetryStrategy:function(s){return Math.min(s*10,1e3)},sentinelReconnectStrategy:function(){return 6e4},natMap:null,enableTLSForSentinelMode:false,updateSentinels:true,failoverDetector:false,username:null,password:null,db:0,enableOfflineQueue:true,enableReadyCheck:true,autoResubscribe:true,autoResendUnfulfilledCommands:true,lazyConnect:false,keyPrefix:"",reconnectOnError:null,readOnly:false,stringNumbers:false,maxRetriesPerRequest:20,maxLoadingRetryTime:1e4,enableAutoPipelining:false,autoPipeliningIgnoredCommands:[],sentinelMaxConnections:10,blockingTimeoutGrace:100};});var G=p(Is=>{Object.defineProperty(Is,"__esModule",{value:true});var Ii=ae(),Fi=k("events"),Bs=K(),qc=cs(),ne=Q(),jc=pi(),Lc=rt(),X=Ri(),Di=Bi(),Qc=Ke(),zc=Vt(),oe=x(),Gc=Ht(),Uc=Ye(),Z=je(),Pi=Xe(),$=(0, oe.Debug)("redis"),ee=class s extends Uc.default{constructor(e,t,r){if(super(),this.status="wait",this.isCluster=false,this.reconnectTimeout=null,this.connectionEpoch=0,this.retryAttempts=0,this.manuallyClosing=false,this._autoPipelines=new Map,this._runningAutoPipelines=new Set,this.parseOptions(e,t,r),Fi.EventEmitter.call(this),this.resetCommandQueue(),this.resetOfflineQueue(),this.options.Connector)this.connector=new this.options.Connector(this.options);else if(this.options.sentinels){let i=new Lc.default(this.options);i.emitter=this,this.connector=i;}else this.connector=new jc.StandaloneConnector(this.options);this.options.scripts&&Object.entries(this.options.scripts).forEach(([i,n])=>{this.defineCommand(i,n);}),this.options.lazyConnect?this.setStatus("wait"):this.connect().catch(Z.noop);}static createClient(...e){return new s(...e)}get autoPipelineQueueSize(){let e=0;for(let t of this._autoPipelines.values())e+=t.length;return e}connect(e){let t=new Promise((r,i)=>{if(this.status==="connecting"||this.status==="connect"||this.status==="ready"){i(new Error("Redis is already connecting/connected"));return}this.connectionEpoch+=1,this.setStatus("connecting");let{options:n}=this;this.condition={select:n.db,auth:n.username?[n.username,n.password]:n.password,subscriber:false};let o=this;(0, Bs.default)(this.connector.connect(function(c,a){o.silentEmit(c,a);}),function(c,a){if(c){o.flushQueue(c),o.silentEmit("error",c),i(c),o.setStatus("end");return}let u=n.tls?"secureConnect":"connect";if("sentinels"in n&&n.sentinels&&!n.enableTLSForSentinelMode&&(u="connect"),o.stream=a,n.noDelay&&a.setNoDelay(true),typeof n.keepAlive=="number"&&(a.connecting?a.once(u,()=>{a.setKeepAlive(true,n.keepAlive);}):a.setKeepAlive(true,n.keepAlive)),a.connecting){if(a.once(u,X.connectHandler(o)),n.connectTimeout){let h=false;a.setTimeout(n.connectTimeout,function(){if(h)return;a.setTimeout(0),a.destroy();let d=new Error("connect ETIMEDOUT");d.errorno="ETIMEDOUT",d.code="ETIMEDOUT",d.syscall="connect",X.errorHandler(o)(d);}),a.once(u,function(){h=true,a.setTimeout(0);});}}else if(a.destroyed){let h=o.connector.firstError;h&&process.nextTick(()=>{X.errorHandler(o)(h);}),process.nextTick(X.closeHandler(o));}else process.nextTick(X.connectHandler(o));a.destroyed||(a.once("error",X.errorHandler(o)),a.once("close",X.closeHandler(o)));let f=function(){o.removeListener("close",l),r();};var l=function(){o.removeListener("ready",f),i(new Error(oe.CONNECTION_CLOSED_ERROR_MSG));};o.once("ready",f),o.once("close",l);});});return (0, Bs.default)(t,e)}disconnect(e=false){e||(this.manuallyClosing=true),this.reconnectTimeout&&!e&&(clearTimeout(this.reconnectTimeout),this.reconnectTimeout=null),this.status==="wait"?X.closeHandler(this)():this.connector.disconnect();}end(){this.disconnect();}duplicate(e){return new s({...this.options,...e})}get mode(){var e;return this.options.monitor?"monitor":!((e=this.condition)===null||e===void 0)&&e.subscriber?"subscriber":"normal"}monitor(e){let t=this.duplicate({monitor:true,lazyConnect:false});return (0, Bs.default)(new Promise(function(r,i){t.once("error",i),t.once("monitoring",function(){r(t);});}),e)}sendCommand(e,t){var r,i;if(this.status==="wait"&&this.connect().catch(Z.noop),this.status==="end")return e.reject(new Error(oe.CONNECTION_CLOSED_ERROR_MSG)),e.promise;if(!((r=this.condition)===null||r===void 0)&&r.subscriber&&!ne.default.checkFlag("VALID_IN_SUBSCRIBER_MODE",e.name))return e.reject(new Error("Connection in subscriber mode, only subscriber commands may be used")),e.promise;typeof this.options.commandTimeout=="number"&&e.setTimeout(this.options.commandTimeout);let n=this.getBlockingTimeoutInMs(e),o=this.status==="ready"||!t&&this.status==="connect"&&(0, Ii.exists)(e.name,{caseInsensitive:true})&&((0, Ii.hasFlag)(e.name,"loading",{nameCaseInsensitive:true})||ne.default.checkFlag("HANDSHAKE_COMMANDS",e.name));if(this.stream&&this.stream.writable?this.stream._writableState&&this.stream._writableState.ended&&(o=false):o=false,o)$.enabled&&$("write command[%s]: %d -> %s(%o)",this._getDescription(),(i=this.condition)===null||i===void 0?void 0:i.select,e.name,e.args),t?"isPipeline"in t&&t.isPipeline?t.write(e.toWritable(t.destination.redis.stream)):t.write(e.toWritable(t)):this.stream.write(e.toWritable(this.stream)),this.commandQueue.push({command:e,stream:t,select:this.condition.select}),n!==void 0&&e.setBlockingTimeout(n),ne.default.checkFlag("WILL_DISCONNECT",e.name)&&(this.manuallyClosing=true),this.options.socketTimeout!==void 0&&this.socketTimeoutTimer===void 0&&this.setSocketTimeout();else {if(!this.options.enableOfflineQueue)return e.reject(new Error("Stream isn't writeable and enableOfflineQueue options is false")),e.promise;if(e.name==="quit"&&this.offlineQueue.length===0)return this.disconnect(),e.resolve(Buffer.from("OK")),e.promise;if($.enabled&&$("queue command[%s]: %d -> %s(%o)",this._getDescription(),this.condition.select,e.name,e.args),this.offlineQueue.push({command:e,stream:t,select:this.condition.select}),ne.default.checkFlag("BLOCKING_COMMANDS",e.name)){let c=this.getConfiguredBlockingTimeout();c!==void 0&&e.setBlockingTimeout(c);}}if(e.name==="select"&&(0, oe.isInt)(e.args[0])){let c=parseInt(e.args[0],10);this.condition.select!==c&&(this.condition.select=c,this.emit("select",c),$("switch to db [%d]",this.condition.select));}return e.promise}getBlockingTimeoutInMs(e){var t;if(!ne.default.checkFlag("BLOCKING_COMMANDS",e.name))return;let r=this.getConfiguredBlockingTimeout();if(r===void 0)return;let i=e.extractBlockingTimeout();if(typeof i=="number")return i>0?i+((t=this.options.blockingTimeoutGrace)!==null&&t!==void 0?t:Di.DEFAULT_REDIS_OPTIONS.blockingTimeoutGrace):r;if(i===null)return r}getConfiguredBlockingTimeout(){if(typeof this.options.blockingTimeout=="number"&&this.options.blockingTimeout>0)return this.options.blockingTimeout}setSocketTimeout(){this.socketTimeoutTimer=setTimeout(()=>{this.stream.destroy(new Error(`Socket timeout. Expecting data, but didn't receive any in ${this.options.socketTimeout}ms.`)),this.socketTimeoutTimer=void 0;},this.options.socketTimeout),this.stream.once("data",()=>{clearTimeout(this.socketTimeoutTimer),this.socketTimeoutTimer=void 0,this.commandQueue.length!==0&&this.setSocketTimeout();});}scanStream(e){return this.createScanStream("scan",{options:e})}scanBufferStream(e){return this.createScanStream("scanBuffer",{options:e})}sscanStream(e,t){return this.createScanStream("sscan",{key:e,options:t})}sscanBufferStream(e,t){return this.createScanStream("sscanBuffer",{key:e,options:t})}hscanStream(e,t){return this.createScanStream("hscan",{key:e,options:t})}hscanBufferStream(e,t){return this.createScanStream("hscanBuffer",{key:e,options:t})}zscanStream(e,t){return this.createScanStream("zscan",{key:e,options:t})}zscanBufferStream(e,t){return this.createScanStream("zscanBuffer",{key:e,options:t})}silentEmit(e,t){let r;if(!(e==="error"&&(r=t,this.status==="end"||this.manuallyClosing&&r instanceof Error&&(r.message===oe.CONNECTION_CLOSED_ERROR_MSG||r.syscall==="connect"||r.syscall==="read"))))return this.listeners(e).length>0?this.emit.apply(this,arguments):(r&&r instanceof Error&&console.error("[ioredis] Unhandled error event:",r.stack),false)}recoverFromFatalError(e,t,r){this.flushQueue(t,r),this.silentEmit("error",t),this.disconnect(true);}handleReconnection(e,t){var r;let i=false;switch(this.options.reconnectOnError&&!ne.default.checkFlag("IGNORE_RECONNECT_ON_ERROR",t.command.name)&&(i=this.options.reconnectOnError(e)),i){case 1:case  true:this.status!=="reconnecting"&&this.disconnect(true),t.command.reject(e);break;case 2:this.status!=="reconnecting"&&this.disconnect(true),((r=this.condition)===null||r===void 0?void 0:r.select)!==t.select&&t.command.name!=="select"&&this.select(t.select),this.sendCommand(t.command);break;default:t.command.reject(e);}}_getDescription(){let e;return "path"in this.options&&this.options.path?e=this.options.path:this.stream&&this.stream.remoteAddress&&this.stream.remotePort?e=this.stream.remoteAddress+":"+this.stream.remotePort:"host"in this.options&&this.options.host?e=this.options.host+":"+this.options.port:e="",this.options.connectionName&&(e+=` (${this.options.connectionName})`),e}resetCommandQueue(){this.commandQueue=new Pi;}resetOfflineQueue(){this.offlineQueue=new Pi;}parseOptions(...e){let t={},r=false;for(let i=0;i<e.length;++i){let n=e[i];if(!(n===null||typeof n>"u"))if(typeof n=="object")(0, Z.defaults)(t,n);else if(typeof n=="string")(0, Z.defaults)(t,(0, oe.parseURL)(n)),n.startsWith("rediss://")&&(r=true);else if(typeof n=="number")t.port=n;else throw new Error("Invalid argument "+n)}r&&(0, Z.defaults)(t,{tls:true}),(0, Z.defaults)(t,s.defaultOptions),typeof t.port=="string"&&(t.port=parseInt(t.port,10)),typeof t.db=="string"&&(t.db=parseInt(t.db,10)),this.options=(0, oe.resolveTLSProfile)(t);}setStatus(e,t){$.enabled&&$("status[%s]: %s -> %s",this._getDescription(),this.status||"[empty]",e),this.status=e,process.nextTick(this.emit.bind(this,e,t));}createScanStream(e,{key:t,options:r={}}){return new Qc.default({objectMode:true,key:t,redis:this,command:e,...r})}flushQueue(e,t){t=(0, Z.defaults)({},t,{offlineQueue:true,commandQueue:true});let r;if(t.offlineQueue)for(;r=this.offlineQueue.shift();)r.command.reject(e);if(t.commandQueue&&this.commandQueue.length>0)for(this.stream&&this.stream.removeAllListeners("data");r=this.commandQueue.shift();)r.command.reject(e);}_readyCheck(e){let t=this;this.info(function(r,i){if(r)return r.message&&r.message.includes("NOPERM")?(console.warn(`Skipping the ready check because INFO command fails: "${r.message}". You can disable ready check with "enableReadyCheck". More: https://github.com/luin/ioredis/wiki/Disable-ready-check.`),e(null,{})):e(r);if(typeof i!="string")return e(null,i);let n={},o=i.split(`\r
`);for(let c=0;c<o.length;++c){let[a,...u]=o[c].split(":"),f=u.join(":");f&&(n[a]=f);}if(!n.loading||n.loading==="0")e(null,n);else {let c=(n.loading_eta_seconds||1)*1e3,a=t.options.maxLoadingRetryTime&&t.options.maxLoadingRetryTime<c?t.options.maxLoadingRetryTime:c;$("Redis server still loading, trying again in "+a+"ms"),setTimeout(function(){t._readyCheck(e);},a);}}).catch(Z.noop);}};ee.Cluster=qc.default;ee.Command=ne.default;ee.defaultOptions=Di.DEFAULT_REDIS_OPTIONS;(0, Gc.default)(ee,Fi.EventEmitter);(0, zc.addTransactionSupport)(ee.prototype);Is.default=ee;});var ji=p((S,qi)=>{Object.defineProperty(S,"__esModule",{value:true});S.print=S.ReplyError=S.SentinelIterator=S.SentinelConnector=S.AbstractConnector=S.Pipeline=S.ScanStream=S.Command=S.Cluster=S.Redis=S.default=void 0;S=qi.exports=G().default;var Kc=G();Object.defineProperty(S,"default",{enumerable:true,get:function(){return Kc.default}});var Vc=G();Object.defineProperty(S,"Redis",{enumerable:true,get:function(){return Vc.default}});var Yc=cs();Object.defineProperty(S,"Cluster",{enumerable:true,get:function(){return Yc.default}});var Hc=Q();Object.defineProperty(S,"Command",{enumerable:true,get:function(){return Hc.default}});var Wc=Ke();Object.defineProperty(S,"ScanStream",{enumerable:true,get:function(){return Wc.default}});var Jc=Gt();Object.defineProperty(S,"Pipeline",{enumerable:true,get:function(){return Jc.default}});var Xc=tt();Object.defineProperty(S,"AbstractConnector",{enumerable:true,get:function(){return Xc.default}});var Ni=rt();Object.defineProperty(S,"SentinelConnector",{enumerable:true,get:function(){return Ni.default}});Object.defineProperty(S,"SentinelIterator",{enumerable:true,get:function(){return Ni.SentinelIterator}});S.ReplyError=se().ReplyError;Object.defineProperty(S,"Promise",{get(){return console.warn("ioredis v5 does not support plugging third-party Promise library anymore. Native Promise will be used."),Promise},set(s){console.warn("ioredis v5 does not support plugging third-party Promise library anymore. Native Promise will be used.");}});function Zc(s,e){console.log(s?"Error: "+s:"Reply: "+e);}S.print=Zc;});var Wi=on(ji());var Li=s=>{let e,t,r=new Promise((i,n)=>{t=n,e=setTimeout(i,s*1e3);});return r.cancel=()=>{clearTimeout(e),t(new Error("Sleep cancelled"));},r};var $c=function(s,e=[],t=0,r=4e3){let i=function(){t<0?Be.abort():Be.exit(t);};for(let n of e)n?.kill&&n.kill("SIGTERM");s?.close?s.close(i):i(),setTimeout(i,r).unref();},Qi=function(s,e=[]){Be.on("uncaughtException",t=>console.error("Error:",t)),Be.on("unhandledRejection",t=>console.error("Promise Rejection:",t)),["SIGTERM","SIGINT"].forEach(t=>{Be.on(t,()=>{console.log(t),$c(s,e);});});};var zi=Be.env.PORT||8080,Gi=2;var ol=fileURLToPath(import.meta.url),Ui=Fs.dirname(ol),al="v2026.2.14",cl=s=>{try{let e=at.platform()==="win32"?`where ${s}`:`which ${s}`;return execSync(e,{stdio:"ignore"}),!0}catch{return  false}},Ki=(s,e)=>new Promise((t,r)=>{rl.get(s,i=>{if(i.statusCode&&i.statusCode>=300&&i.statusCode<400&&i.headers.location)return Ki(i.headers.location,e).then(t).catch(r);if(i.statusCode!==200){r(new Error(`Download failed: ${i.statusCode}`));return}let n=Ps.createWriteStream(e);i.pipe(n),n.on("finish",()=>{if(at.platform()!=="win32")try{Ps.chmodSync(e,493);}catch(o){r(o);}n.close(),t();});}).on("error",i=>{Ps.unlink(e,()=>{}),r(i);});}),ll=()=>{let s=`https://github.com/YaronKoresh/build-redis/releases/download/${al}`,e=at.platform();return e==="win32"?[`${s}/redis-server-windows.exe`,`${s}/redis-cli-windows.exe`,`${s}/msys-2.0.dll`]:e==="darwin"?[`${s}/redis-server-macos`,`${s}/redis-cli-macos`]:[`${s}/redis-server-linux`,`${s}/redis-cli-linux`]},Ds=(s=6379)=>new Promise(e=>{let t=Yi.createConnection({port:s,host:"0.0.0.0"});t.on("connect",()=>{t.end(),e(true);}),t.on("error",()=>{e(false);});}),ul=async()=>{if(await Ds())return;let s=at.platform(),e="redis-server";if(!cl(e)){let r=ll();e=Fs.join(Ui,"..",r[0].split("/").pop());for(let i of r){let n=Fs.join(Ui,"..",i.split("/").pop());await Ki(i,n);}}let t=spawn(e,[],{detached:true,stdio:"inherit",shell:s==="win32"});t.on("error",r=>{console.error("Failed to spawn Redis process:",r);}),t.on("exit",(r,i)=>{r!==0&&console.error(`Redis process exited unexpectedly with code ${r} and signal ${i}`);}),t.unref();};var Vi=ul;var yl=fileURLToPath(import.meta.url),gl=Fs.dirname(yl),_e=Number(Gi),Ie=Number(zi),ml=async()=>{await Vi();for(let l=0;l<10&&!await Ds();l++)await Li(2);let s=new Wi.Redis("redis://0.0.0.0:6379");s.on("error",l=>{console.error("Redis Client Error:",l);});let e=new Map,t=new Map,r=5e3,i=0,n=0,o=l=>{let h=Fs.join(gl,"..","server","index.js"),d=spawn("node",[h,String(l),String(n)],{detached:false,shell:false,stdio:"inherit"});return d.on("error",g=>{console.error(`\u274C Failed to spawn worker on port ${l}:`,g);}),d.on("exit",()=>{e.delete(l),t.set(l,Date.now()),setTimeout(()=>t.delete(l),r).unref();}),e.set(l,d),d};for(let l=0;l<_e;l++){n++;let h=Ie+l+2;o(h);}let c=()=>{if(t.size>_e*.5){n++;let l=Ie+ ++_e+2;o(l);}},a=async l=>{let h=l.remoteAddress||"unknown",d=0,g=0;try{let m=await s.get(`session:${h}`);m&&!t.has(Number(m))&&(d=Number(m));}catch(m){console.error(m);}let v=()=>{if(g>=_e){c(),l.destroy();return}if((!d||t.has(d))&&(d=Ie+i%_e+1,i++),g++,t.has(d))return d=0,v();let m=Yi.createConnection({port:d,host:"0.0.0.0"});m.setTimeout(3e4),m.once("error",()=>{t.set(d,Date.now()),setTimeout(()=>t.delete(d),r).unref(),m.destroy(),d=0,v();}),m.once("timeout",()=>{m.destroy(),d=0,v();}),m.once("connect",()=>{m.setTimeout(0),s.set(`session:${h}`,d,"EX",3e4).catch(()=>{}),l.pipe(m).pipe(l);}),l.once("error",()=>m.destroy());};v();},u=Yi.createServer(l=>{a(l).catch(h=>{console.error(h),l.destroy();});}),f=hl.createServer((l,h)=>{if(l.url==="/status"){h.writeHead(200,{"Content-Type":"application/json"}),h.end(JSON.stringify({pool:{total:_e,active:e.size,dead:t.size},workers:Array.from(e.keys()),quarantine:Array.from(t.keys())},null,2));return}h.writeHead(404).end();});await Promise.all([new Promise((l,h)=>{u.listen(Ie,"localhost",()=>l()),u.on("error",h);}),new Promise(l=>{f.listen(Ie+1,"localhost",()=>l());})]),Qi(u,Array.from(e.values()));};ml().catch(s=>{console.error(s),Be.exit(1);});